---
title: "Penetration"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
setwd('/Users/arthur/Desktop')
```

# Import and Process Price CSV File
```{r}
Price = read.csv("Price.csv")
colnames(Price) <- c('Country', 'Country_Code', 'Price_LowSpeed', 'Price_MedSpeed', 'Price_HighSpeed', 'Price_VeryHighSpeed')
colnames(Price)
```

# Import and Process Penetration CSV File
```{r}
Penetration = read.csv("Penetration.csv")
#Drop the NA Column which contains no data
Penetration <- Penetration[, 0:12]
colnames(Penetration) <- c('Country', 'Country_Code', 'Penetration_OECD_2008', 'Penetration_OECD_2007', 'Penetration_OECD_Household', 'Penetration_OECD_2G_3G', 'Penetration_GC_Penetration', 'Penetration_3G', 'Growth_3G_Penetration', 'WiFi_Hotspots', 'Wifi_Hotspots_Per_100,000', 'Percent_Population_Urban')
colnames(Penetration)
```
# Explore Penetration variable: Use visualizations and descriptive statistics to perform a univariate analysis of each key variable.

```{r}
summary(Penetration)
# Looking at the summary statistics of each variable, 
```
```{r}
library(car)
boxplot(Penetration$Penetration_OECD_2008, Penetration$Penetration_OECD_Household, main = 'Penetration_OECD_2008 vs. Penetration_OECD_Household')
```
# We were interested in looking at the difference between penetration per 100 inhabitants versus penetration by household. Looking at the distribution for each boxplot,  Penetration per 100 inhabitants in 2008 has a smaller range and a lower median than Penetration per Household. Upon further reading, looking at penetration by household may be misleading since it includes some connections to businesses.

```{r}
Negative = Penetration$Penetration_OECD_2007 > Penetration$Penetration_OECD_2008 
NP = Penetration[Negative, ]
NP
```
# We wanted to see if any country experienced negative growth between 2007 and 2008. Finland appeared to be the only country with a negative growth but upon closer inspection, the decrease was only of 0.1 per 100 inhabitants.

```{r}
boxplot(Penetration$Penetration_OECD_Household, Penetration$WiFi_Hotspots, main = 'Penetration_OECD_Household vs. WiFi_Hotspots')
```


# Penetration_OECD variable measures the subscriptions per 100 inhabitants
```{r}
boxplot(Penetration[,3:4])
```
# From 2007 to 2008, there's been an overall increase in Penetration_OECD values. Top three countries with highest Penetration in 2007 were Denmark, Netherlands and Switzerland. Bottom three were Mexico, Turkey and Slovak Republic. In 2008, Denmark and Netherlands remained the top 2 while Norway replaced Switzerland among the Top 3. Mexico and Turkey remained in the bottom 3 while Poland replaced Slovak among the bottom 3.

```{r}
barplot(Penetration$Penetration_OECD_2007, names.arg=Penetration$Country, horiz=TRUE, las=1, cex.names=0.5, border=NA)
```
```{r}
barplot(Penetration$Penetration_OECD_2008, names.arg=Penetration$Country
        , horiz=TRUE, las=1, cex.names=0.5, border=NA)
```
```{r}

```

# Penetration_OECD_Household measures the subscriptions per 100 households. When looking at this variable, top three countries are Korea, Iceland and Netherlands.
```{r}
barplot(Penetration$Penetration_OECD_Household, names.arg=Penetration$Country
        , horiz=TRUE, las=1, cex.names=0.5, border=NA)
```

# Be sure to describe any anomalies, coding issues, or potentially erroneous values. Explain how you respond to each issue you identify. 

# Note any features that appear relevant to statistical analysis. Discuss what transformations may be appropriate for each variable.
# Import and Process Speed CSV File
```{r}
Speed = read.csv("Speed.csv")
colnames(Speed) <- c('Country', 'Country_Code', 'Maximum_Advertised_kbps', 'Avg_Advertised_kbps', 'Avg_Actual_kbps', 'Avg_Download_kbps', 'SD_Download_kbps', 'Avg_Upload_kbps', 'SD_Upload_kbps', 'Avg_Latency', 'SD_Latency', 'Median_Download_kbps', 'Median_Upload_kbps', 'Median_Latency', 'X90_Download_kbps', 'X90_Upload_kbps', 'X10_Latency')
colnames(Speed)
```

# Join 3 Datasets together via full join. Join via Country Code because it's more standardized than Country (Eliminate mis-spelling and/or capitalized vs not-capitalized)
```{r}
library("dplyr")
join1 = full_join(Price, Penetration, by = c("Country_Code" ="Country_Code"))
Broadband = full_join(join1, Speed, by = c("Country_Code" ="Country_Code"))
head(Broadband)
```

 
```{r}
names(Broadband)
```


