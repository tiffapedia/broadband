---
title: "Penetration"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

# Import and Process Price CSV File
```{r}
Price = read.csv("Price.csv")
colnames(Price) <- c('Country', 'Country_Code', 'Price_LowSpeed', 'Price_MedSpeed', 'Price_HighSpeed', 'Price_VeryHighSpeed')

Price[Price==""] <- NA

Price
```

# Import and Process Penetration CSV File
```{r}
Penetration = read.csv("Penetration.csv")
# Drop the NA Column and NA row which contains no data
Penetration <- Penetration[0:30, 0:12]
colnames(Penetration) <- c('Country', 'Country_Code', 'Penetration_OECD_2008', 'Penetration_OECD_2007', 'Penetration_OECD_Household', 'Penetration_OECD_2G_3G', 'Penetration_GC_Penetration', 'Penetration_3G', 'Growth_3G_Penetration', 'WiFi_Hotspots', 'Wifi_Hotspots_Per_100,000', 'Percent_Population_Urban')
(Penetration)
# The penetration variable contains 30 rows (which represent counties) and 12 columns (which represent different penetration variables).

```
# Explore Penetration variable: Use visualizations and descriptive statistics to perform a univariate analysis of each key variable.

```{r}
summary(Penetration)
# First, wanted to look at summary statistics to see how values vary and whether it makes sense. Notes:
# - Since Penetration_OECD_2008, Penetration_OECD_2007 and Penetration_OECD_Household are based on a per 100 inhabitants or household basis, the distribution for Penetration_OECD_2G_3G is confounding as its values range from a minimum of 62 to a maximum of 151. This is something we will look into.
# - Growth_3G_Penetration and Percent_Population_Urban are in percent units
# - WiFi_Hotspots values have a much higher range than all other variables.
```

```{r}
#Next we wanted to look at how the the penetration values are distributed to get a sense of the range of values. Here we notice that the distribution of values rises almost regularly to a peak before falling sharply, overall the data reflect a negative skew. 

hist(Penetration$Penetration_OECD_2008, main="Penetration per 100 inhabitants in OECD 2008",  xlab = "Penetration (per 100 inhabitants)")
#may need ot be rebinned
```
```{r}
#then we wanted to compare the distributions for 2007 and 2008. Notes: a we can see the distribution when compared to the previous year does not look nearly as uniform. There is a greater frequency of values above 30 inhabitants (per 100) than in the following year which makes us want to take a closer look at the difference in penetration values between the two year from OECD data. to see if we can get a better sense of how penetration grew between these two years.

hist(Penetration$Penetration_OECD_2007, main="Penetration per 100 inhabitants in OECD 2007",  xlab = "Penetration (per 100 inhabitants)")
# may need to be rebinned
```
```{r}
Difference = Penetration$Penetration_OECD_2008 - Penetration$Penetration_OECD_2007
Difference

Year_Comparison = data.frame(Penetration$Country, Penetration$Penetration_OECD_2007, Penetration$Penetration_OECD_2008, Difference)
Year_Comparison

#Notes: We can see that with the exception of Finland all other OECD member countries saw growth in penetration per 100 inhabitants between 2007 and 2008. Interestingly, Finland shows negative growth of .01 inhabitants per 100 while the rest of the member countries show some growth between 2007 and 2008. 
```
```{r}
summary(Difference)

#Looking at the summary of difference we see that average change in penetration between 2007 and 2008 in the OECD data is 2.3 inhabitants per 100. The minimum is our negative value with Finland and the max is 3.81 in the SLovak republic. 

```
```{r}
# Next, we wanted to look at the relationship between values from the same time period. Since most variable years were unspecified, we assumed OECD data was mainly from 2007. 

cor(Penetration[ , c("Penetration_OECD_2007", "Penetration_OECD_Household", "Penetration_OECD_2G_3G")], use = "complete.obs")

#Looking at the correlation values, it looks like Penetration_OECD_Household and Penetration_OECD_2007 have a a 0.93 correlation, while the two variables have a weak linear relationship with Penetration_OECD_2G_3G variable.
```
```{r}
# Data from GlobalComms is slightly more updated, as it is copyrighted in 2009, so we’re assuming the data shared is from 2008. We’ll compare Penetration_OECD_2008 with Penetration per 100 GC and 3G penetration per 100. 

cor(Penetration[ , c("Penetration_OECD_2008", "Penetration_GC_Penetration", "Penetration_3G")], use = "complete.obs")

# Looking at correlation values, it appears that Penetration_OECD_2008 and Penetration_GC_Penetration have almost a 1:1 linear relationship, which makes sense since they are measuring the same value, namely the penetration per 100 inhabitants in 2008. 
```
```{r}
# Since neither Penetration_OECD_2G_3G nor Penetration_3G held a strong linear relationship with other variables, we wanted to see if the two were correlated in any way. However, it appeared there was not a strong correlation between the two variables.
cor(Penetration[,c("Penetration_OECD_2G_3G", "Penetration_3G")])
```

```{r}
# Next, we wanted to look at the growth of 3G Penetration by country. To do so, we had to convert the percentage values into decimals. 
Growth_3G = as.numeric(sub("%","",Penetration$Growth_3G_Penetration))/100
Penetration$Growth_3G_Dec = Growth_3G
```

```{r}
barplot(Penetration$Growth_3G_Dec, names.arg=Penetration$Country, horiz=TRUE, las=1, cex.names=0.5, border=NA, main = "Growth of 3G Penetration by Country", xlab = "Percentage in decimals")
```

```{r}
Population_Urban = as.numeric(sub("%","",Penetration$Percent_Population_Urban))/100
Penetration$Population_Urban_Dec = Population_Urban

barplot(Penetration$Population_Urban_Dec, names.arg=Penetration$Country, horiz=TRUE, las=1, cex.names=0.5, border=NA, main = "% of Pop. in Urban Areas by Country", xlab = "Percentage in decimals")
```

```{r}
#Looking at Percent of Pop. in Urban areas, it appears that Poland has more than 100% of its population in urban areas, which must be an error. If we disregard this error in entry, Belgium, Iceland and U.K would appear to have the highest % of population in urban areas. Slovak Republic, Portugal and Greece appear to have the lowest % of pop. in urban areas. With this mind, we wondered if percentage of population in urban areas meant higher penetration. 

barplot(Penetration$Penetration_OECD_2007, names.arg=Penetration$Country
        , horiz=TRUE, las=1, cex.names=0.5, border=NA, main = "Penetration per 100 Inhabitants by Country - 2007")

# In 2007, Denmark, Netherlands and Switzerland were the top 3 countries with highest penetration, and Mexico, Turkey and Slovak were the bottom 3. 
```

```{r}
barplot(Penetration$Penetration_OECD_2008, names.arg=Penetration$Country, horiz=TRUE, las=1, cex.names=0.5, border=NA, main = "Penetration per 100 Inhabitants by Country - 2008")

#top_5_Pen_08 = order(Broadband$Penetration_OECD_2008, decreasing=TRUE)[1:5]
#Broadband[top_5,]

# In 2008, Denmark, Netherlands and Norway were among the Top 3 countries with highest Penetration. Mexico, Turkey and Poland were the bottom 3.
```

```{r}
# There appears to be no strong relationship between Penetration per 100 Inhabitants and Percentage of Pop. in Urban areas. Next we looked at Penetration per Household, which measures the subscriptions per 100 households. When looking at this variable, top five countries were Korea, Iceland, Netherlands, Denmark and Sweden, with an average of 89% population in urban areas. The bottom five countries were Turkey, Mexico, Greece, Italy and Slovak, with an average of 65% population in urban areas. 

# Top: Korea - 0.81 Iceland - 0.93 Netherlands - 0.80 Denmark - 0.86 Sweden 0.84
# Bottom: Turkey 0.67 Mexico 0.76 Greece - 0.59 Italy - 0.68 Slovak 0.56

barplot(Penetration$Penetration_OECD_Household, names.arg=Penetration$Country
        , horiz=TRUE, las=1, cex.names=0.5, border=NA, main = "Penetration per 100 Households by Country - 2007")


```

```{r}
data.frame(Penetration$Country, Penetration$Population_Urban_Dec)
```
```{r}
#We also wanted to look at the correlation between wifi hotspots per 100000 residents and percentage of urban populations.  There seems to be a slight negative correlation but really its so close to zero that there is not really a linear relationship. 

cor(Penetration$`Wifi_Hotspots_Per_100,000`, Penetration$Population_Urban_Dec)

```
```{r}
library(car)
scatterplot(Penetration$`Wifi_Hotspots_Per_100,000`, Penetration$Population_Urban_Dec, main = "Urban Population and Wifi Hotspots", ylab = "Urban Population(as decimal)", xlab = "Wifi Hotspots (per 100,000 inhabitants)")

#Graph needs ot be cleaned up
#There seems to be a couple of outliers but in general the very slightly negative sloping/non linear correlation (green line) is reflected here. 
```

```{r}
#We wanted to see if we could compare WiFi hot spots per 100 inhabitants to penetration per 100 inhabitants. To do this we took the values for WiFi per 100,000 inhabitants and divided by 1,000. The transformation as applied to wifi_hotpots per 100,000 inhabitants was not helpful. I wonder if we need to apply a logarithmic transformation instead of simple division.

Wifi_hotspots_100 = Penetration$`Wifi_Hotspots_Per_100,000` / 1000

Wifi_compare = data.frame(Penetration$Country, Penetration$Penetration_OECD_2008, Wifi_hotspots_100)

Wifi_compare
```




# Be sure to describe any anomalies, coding issues, or potentially erroneous values. Explain how you respond to each issue you identify. 

# Note any features that appear relevant to statistical analysis. Discuss what transformations may be appropriate for each variable.
# Import and Process Speed CSV File


```{r}
Speed = read.csv("Speed.csv")
colnames(Speed) <- c('Country', 'Country_Code', 'Maximum_Advertised_kbps', 'Avg_Advertised_kbps', 'Avg_Actual_kbps', 'Avg_Download_kbps', 'SD_Download_kbps', 'Avg_Upload_kbps', 'SD_Upload_kbps', 'Avg_Latency', 'SD_Latency', 'Median_Download_kbps', 'Median_Upload_kbps', 'Median_Latency', 'X90_Download_kbps', 'X90_Upload_kbps', 'X10_Latency')
Speed <- Speed[0:30,]
Speed
```

# Join 3 Datasets together via full join. Join via Country Code because it's more standardized than Country (Eliminate mis-spelling and/or capitalized vs not-capitalized)
```{r}
library("dplyr")
join1 = full_join(Price, Penetration, by = c("Country_Code" ="Country_Code"))
Broadband = full_join(join1, Speed, by = c("Country_Code" ="Country_Code"))
Broadband
```

 
```{r}
# Before looking at the relationship between Penetration and Price, we had to turn the Price columns into numeric values. 

Price_LowSpeed = as.numeric(sub('\\$','',as.character(Broadband$Price_LowSpeed)))
Broadband$Price_LowSpeed_Num = Price_LowSpeed

Price_MedSpeed = as.numeric(sub('\\$','',as.character(Broadband$Price_MedSpeed)))
Broadband$Price_MedSpeed_Num = Price_MedSpeed

Price_HighSpeed = as.numeric(sub('\\$','',as.character(Broadband$Price_HighSpeed)))
Broadband$Price_HighSpeed_Num = Price_HighSpeed

Price_VeryHighSpeed = as.numeric(sub('\\$','',as.character(Broadband$Price_VeryHighSpeed)))
Broadband$Price_VeryHighSpeed_Num = Price_VeryHighSpeed
# Check if conversion worked:
head(Broadband)
```

# To begin looking at the relationship between Penetration and Price, we started with the question: Does higher penetration per 100 inhabitants mean lower prices for high speed or very high speed internet?
```{r}
top_5_Pen_08 = order(Broadband$Penetration_OECD_2008, decreasing=TRUE)[1:5]
Broadband[top_5_Pen_08,]

# Top 5 Countries with the highest penetration per 100 inhabitants were Denmark, Netherlands, Norway, Switzerland and Iceland. 

```

```{r}
par(mfrow = c(2,2))
boxplot(Broadband[top_5_Pen_08,38:39], col="salmon", main=toupper("HS & VS Price for Top 5"), font.main=3, cex.main=1.2)

boxplot(Broadband[,38:39], col="royalblue", main=toupper("HS & VS Price Distribution"), font.main=3, cex.main=1.2)

boxplot(Broadband[top_5_Pen_08,36:37], col="salmon", main=toupper("LS & MS Price for Top 5"), font.main=3, cex.main=1.2)

boxplot(Broadband[,36:37], col="royalblue", main=toupper("LS & MS Price Distribution"), font.main=3, cex.main=1.2)

# Top right - distributions of High Speed and Very High Speed Prices for the Top 5 Countries with the Highest Penetration per 100 Inhabitants. Top left - distributions of High Speed and Very High Speed Prices for all countries. Though the Top 5 countries did not have the lowest prices for either speed, the average prices for both speed were lower than prices overall for all countries. Additionally, the highest prices among the Top 5 countries were around or below the third quartile of prices overall. It's important to note that Very High Speed prices were not available for 11 countries, which may suggest that such an option is unavailable in these countries. 

# Summary stats for HS 
summary(Broadband[top_5_Pen_08,38])
summary(Broadband[,38])

# Summary stats for VHS 
summary(Broadband[top_5_Pen_08,39])
summary(Broadband[,39])

Broadband[is.na(Broadband$Price_VeryHighSpeed_Num),]
```

```{r}
# Bottom right - distributions of Low Speed and Medium Speed Prices for the Top 5 Countries with the Highest Penetration per 100 Inhabitants. Bottom left - distributions of Low Speed and Medium Speed Prices for all countries. Again, the Top 5 Countries did not have the lowest prices, however, their average prices in Low and Medium Speed were lower than that overall. 

# Summary stats for LS 
summary(Broadband[top_5_Pen_08,36])
summary(Broadband[,36])

# Summary stats for MS 
summary(Broadband[top_5_Pen_08,37])
summary(Broadband[,37])
```

```{r}
# Next we looked at the price distributions for the countries with the lowest penetration per 100 inhabitants. 

bottom_5_Pen_08 = order(Broadband$Penetration_OECD_2008, decreasing=FALSE)[1:5]
Broadband[bottom_5_Pen_08,]

# Bottom 5 Countries: Mexico, Turkey, Poland, Slovak Rep. and Greece. 

par(mfrow = c(1,2))
boxplot(Broadband[bottom_5_Pen_08,38:39], col="lightgoldenrod1", main=toupper("HS & VS Price for Bottom 5"), font.main=3, cex.main=1.2)

boxplot(Broadband[,38:39], col="hotpink4", main=toupper("HS & VS Price Distribution"), font.main=3, cex.main=1.2)

# Summary stats for HS 
summary(Broadband[bottom_5_Pen_08,38])
summary(Broadband[,38])

# Summary stats for VHS 
summary(Broadband[bottom_5_Pen_08,39])
summary(Broadband[,39])

# Observations: 
# - HS: Two NA's in HS, both of which were countries within the Bottom 5. Highest price among all countries for HS was price in Poland at $210.36. 
# - VHS: All but Slovak Rep. among the Bottom 5 did not have prices for VHS. Though the price was not the max among countries overall, it is greater than the average cost for VHS among countries overall.
```

```{r}
par(mfrow = c(1,2))
boxplot(Broadband[bottom_5_Pen_08,36:37], col="lightgoldenrod1", main=toupper("LS & MS Price for Bottom 5"), font.main=3, cex.main=1.2)

boxplot(Broadband[,36:37], col="hotpink4", main=toupper("LS & MS Price Distribution"), font.main=3, cex.main=1.2)

# Summary stats for LS 
summary(Broadband[bottom_5_Pen_08,36])
summary(Broadband[,36])

# Summary stats for MS 
summary(Broadband[bottom_5_Pen_08,37])
summary(Broadband[,37])

# Observations: 
# - LS: Highest price among all countries was Mexico which was among the Bottom 5.
# - MS: Highest price among all countries was Poland which was among the Bottom 5.
# Average prices for LS and MS connection in the Bottom 5 Countries were considerably higher than in countries overall. 
Broadband[bottom_5_Pen_08,]
```

# Next we looked at the price distributions for the countries with the highest and lowest penetration per 100 households. 
```{r}
top_5_Household = order(Broadband$Penetration_OECD_Household, decreasing=TRUE)[1:5]
Broadband[top_5_Household,]

# Top 5 Countries: Korea, Iceland, Netherlands, Denmark and Norway, which is the same as the Top 5 Countries with the highest penetration per 100 inhabitants except for Korea.

# Summary stats for HS- Top 5 
summary(Broadband[top_5_Household,38])
summary(Broadband[,38])

# Summary stats for VHS- Top 5
summary(Broadband[top_5_Household,39])
summary(Broadband[,39])

# Summary stats for LS- Top 5
summary(Broadband[top_5_Household,36])
summary(Broadband[,36])

# Summary stats for MS- Top 5
summary(Broadband[top_5_Household,37])
summary(Broadband[,37])

# Observations: 
# Average prices for all connection in the Top 5 Countries with highest penetration by 100 households were lower than price overall. 

```

```{r}
bottom_5_Household = order(Broadband$Penetration_OECD_Household, decreasing=FALSE)[1:5]
Broadband[bottom_5_Household,]

# Bottom 5 Countries were Turkey, Mexico, Greece, Italy, and Slovak Rep. which is the same as the Bottom 5 Countries with lowest penetration per 100 inhabitants, except for Italy.
# Summary stats for HS- Bottom 5 
summary(Broadband[bottom_5_Household,38])
summary(Broadband[,38])

# Summary stats for VHS- Bottom 5
summary(Broadband[bottom_5_Household,39])
summary(Broadband[,39])

# Summary stats for LS- Bottom 5
summary(Broadband[bottom_5_Household,36])
summary(Broadband[,36])

# Summary stats for MS- Bottom 5
summary(Broadband[bottom_5_Household,37])
summary(Broadband[,37])

# Observations: 
# - HS: Two NA's in all countries overall were from countries from the Bottom 5. 
# - VHS: All countries again, except Slovak Rep. did not have prices for VHS.
# - LS: The minimum (Italy at $13.10) and max price (Mexico at $60.23) for LS overall was from countries from the Bottom 5. Average prices among countries in the Bottom 5 again was higher than average overall.
# - MS: Average prices among countries in the Bottom 5 again was higher than average overall.
```

```{r}
top_5_2G_3G = order(Broadband$Penetration_OECD_2G_3G, decreasing=TRUE)[1:5]
Broadband[top_5_2G_3G,]

# Top 5 Countries: Italy, Greece, Luxembourg, Czech rep. and Portugal

# Summary stats for HS- Top 5 2G_3G
summary(Broadband[top_5_2G_3G,38])
summary(Broadband[,38])

# Summary stats for VHS- Top 5 2G_3G
summary(Broadband[top_5_2G_3G,39])
summary(Broadband[,39])

# Summary stats for LS- Top 5 2G_3G
summary(Broadband[top_5_2G_3G,36])
summary(Broadband[,36])

# Summary stats for MS- Top 5 2G_3G
summary(Broadband[top_5_2G_3G,37])
summary(Broadband[,37])

# Observations: 
# - HS: Luxembourg had the lowest price for High Speed connection at $0.69 which may be an error in entry as all other prices were more than 3x that price. Average HS price among these countries were lower than average overall. 
# - VHS: Among the countries with the highest 2G & 3G penetration, only Czech Rep. had a price for Very High Speed, but it also had the highest prices in across all speeds. 
# - LS: Average LS price among these countries were lower than average overall. 
# - MS: Average MS price among these countries were lower than average overall. Max price for MS among these countries was around the avearge MS price overall. 
```


```{r}
cor(Broadband[,c("Penetration_OECD_2008", "Penetration_OECD_Household", "Penetration_OECD_2G_3G", "Penetration_3G", "WiFi_Hotspots", "Price_LowSpeed_Num", "Price_MedSpeed_Num", "Price_HighSpeed_Num", "Price_VeryHighSpeed_Num")], use = "complete.obs")
```


