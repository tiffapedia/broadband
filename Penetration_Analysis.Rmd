---
title: "Penetration"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

# Import and Process Price CSV File
```{r}
Price = read.csv("Price.csv")
colnames(Price) <- c('Country', 'Country_Code', 'Price_LowSpeed', 'Price_MedSpeed', 'Price_HighSpeed', 'Price_VeryHighSpeed')
colnames(Price)
```

# Import and Process Penetration CSV File
```{r}
Penetration = read.csv("Penetration.csv")
# Drop the NA Column and NA row which contains no data
Penetration <- Penetration[0:30, 0:12]
colnames(Penetration) <- c('Country', 'Country_Code', 'Penetration_OECD_2008', 'Penetration_OECD_2007', 'Penetration_OECD_Household', 'Penetration_OECD_2G_3G', 'Penetration_GC_Penetration', 'Penetration_3G', 'Growth_3G_Penetration', 'WiFi_Hotspots', 'Wifi_Hotspots_Per_100,000', 'Percent_Population_Urban')
(Penetration)
# The penetration variable contains 30 rows (which represent counties) and 12 columns (which represent different penetration variables).

```
# Explore Penetration variable: Use visualizations and descriptive statistics to perform a univariate analysis of each key variable.

```{r}
summary(Penetration)
# First, wanted to look at summary statistics to see how values vary and whether it makes sense. Notes:
# - Since Penetration_OECD_2008, Penetration_OECD_2007 and Penetration_OECD_Household are based on a per 100 inhabitants or household basis, the distribution for Penetration_OECD_2G_3G is confounding as its values range from a minimum of 62 to a maximum of 151. This is something we will look into.
# - Growth_3G_Penetration and Percent_Population_Urban are in percent units
# - WiFi_Hotspots values have a much higher range than all other variables.
```

```{r}
#Next we wanted to look at how the the penetration values are distributed to get a sense of the range of values. Here we notice that the distribution of values rises almost regularly to a peak before falling sharply, overall the data reflect a negative skew. 

hist(Penetration$Penetration_OECD_2008, main="Penetration per 100 inhabitants in OECD 2008",  xlab = "Penetration (per 100 inhabitants)")
#may need ot be rebinned
```
```{r}
#then we wanted to compare the distributions for 2007 and 2008. Notes: a we can see the distribution when compared to the previous year does not look nearly as uniform. There is a greater frequency of values above 30 inhabitants (per 100) than in the following year which makes us want to take a closer look at the difference in penetration values between the two year from OECD data. to see if we can get a better sense of how penetration grew between these two years.

hist(Penetration$Penetration_OECD_2007, main="Penetration per 100 inhabitants in OECD 2007",  xlab = "Penetration (per 100 inhabitants)")
# may need to be rebinned
```
```{r}
Difference = Penetration$Penetration_OECD_2008 - Penetration$Penetration_OECD_2007
Difference

Year_Comparison = data.frame(Penetration$Country, Penetration$Penetration_OECD_2007, Penetration$Penetration_OECD_2008, Difference)
Year_Comparison

#Notes: We can see that with the exception of Finland all other OECD member countries saw growth in penetration per 100 inhabitants between 2007 and 2008. Interestingly, Finland shows negative growth of .01 inhabitants per 100 while the rest of the member countries show some growth between 2007 and 2008. 
```
```{r}
summary(Difference)

#Looking at the summary of difference we see that average change in penetration between 2007 and 2008 in the OECD data is 2.3 inhabitants per 100. The minimum is our negative value with Finland and the max is 3.81 in the SLovak republic. 

```
```{r}
# Next, we wanted to look at the relationship between values from the same time period. Since most variable years were unspecified, we assumed OECD data was mainly from 2007. 

cor(Penetration[ , c("Penetration_OECD_2007", "Penetration_OECD_Household", "Penetration_OECD_2G_3G")], use = "complete.obs")

#Looking at the correlation values, it looks like Penetration_OECD_Household and Penetration_OECD_2007 have a a 0.93 correlation, while the two variables have a weak linear relationship with Penetration_OECD_2G_3G variable.
```
```{r}
# Data from GlobalComms is slightly more updated, as it is copyrighted in 2009, so we’re assuming the data shared is from 2008. We’ll compare Penetration_OECD_2008 with Penetration per 100 GC and 3G penetration per 100. 

cor(Penetration[ , c("Penetration_OECD_2008", "Penetration_GC_Penetration", "Penetration_3G")], use = "complete.obs")

# Looking at correlation values, it appears that Penetration_OECD_2008 and Penetration_GC_Penetration have almost a 1:1 linear relationship, which makes sense since they are measuring the same value, namely the penetration per 100 inhabitants in 2008. 
```
```{r}
# Since neither Penetration_OECD_2G_3G nor Penetration_3G held a strong linear relationship with other variables, we wanted to see if the two were correlated in any way. However, it appeared there was not a strong correlation between the two variables.
cor(Penetration[,c("Penetration_OECD_2G_3G", "Penetration_3G")])
```

```{r}
# Next, we wanted to look at the growth of 3G Penetration by country. To do so, we had to convert the percentage values into decimals. 
Growth_3G = as.numeric(sub("%","",Penetration$Growth_3G_Penetration))/100
Penetration$Growth_3G_Dec = Growth_3G
```

```{r}
barplot(Penetration$Growth_3G_Dec, names.arg=Penetration$Country, horiz=TRUE, las=1, cex.names=0.5, border=NA, main = "Growth of 3G Penetration by Country", xlab = "Percentage in decimals")
```

```{r}
Population_Urban = as.numeric(sub("%","",Penetration$Percent_Population_Urban))/100
Penetration$Population_Urban_Dec = Population_Urban

barplot(Penetration$Population_Urban_Dec, names.arg=Penetration$Country, horiz=TRUE, las=1, cex.names=0.5, border=NA, main = "% of Pop. in Urban Areas by Country", xlab = "Percentage in decimals")
```

```{r}
#Looking at Percent of Pop. in Urban areas, it appears that Poland has more than 100% of its population in urban areas, which must be an error. If we disregard this error in entry, Belgium, Iceland and U.K would appear to have the highest % of population in urban areas. Slovak Republic, Portugal and Greece appear to have the lowest % of pop. in urban areas. With this mind, we wondered if percentage of population in urban areas meant higher penetration. 

barplot(Penetration$Penetration_OECD_2007, names.arg=Penetration$Country
        , horiz=TRUE, las=1, cex.names=0.5, border=NA, main = "Penetration per 100 Inhabitants by Country - 2007")

# In 2007, Denmark, Netherlands and Switzerland were the top 3 countries with highest penetration, and Mexico, Turkey and Slovak were the bottom 3. 
```

```{r}
barplot(Penetration$Penetration_OECD_2008, names.arg=Penetration$Country, horiz=TRUE, las=1, cex.names=0.5, border=NA, main = "Penetration per 100 Inhabitants by Country - 2008")

# In 2008, Denmark, Netherlands and Norway were among the Top 3 countries with highest Penetration. Mexico, Turkey and Poland were the bottom 3.
```

```{r}
# There appears to be no strong relationship between Penetration per 100 Inhabitants and Percentage of Pop. in Urban areas. Next we looked at Penetration per Household, which measures the subscriptions per 100 households. When looking at this variable, top five countries were Korea, Iceland, Netherlands, Denmark and Sweden, with an average of 89% population in urban areas. The bottom five countries were Turkey, Mexico, Greece, Italy and Slovak, with an average of 65% population in urban areas. 

# Top: Korea - 0.81 Iceland - 0.93 Netherlands - 0.80 Denmark - 0.86 Sweden 0.84
# Bottom: Turkey 0.67 Mexico 0.76 Greece - 0.59 Italy - 0.68 Slovak 0.56

barplot(Penetration$Penetration_OECD_Household, names.arg=Penetration$Country
        , horiz=TRUE, las=1, cex.names=0.5, border=NA, main = "Penetration per 100 Households by Country - 2007")


```

```{r}
data.frame(Penetration$Country, Penetration$Population_Urban_Dec)
```
```{r}
#We also wanted to look at the correlation between wifi hotspots per 100000 residents and percentage of urban populations.  There seems to be a slight negative correlation but really its so close to zero that there is not really a linear relationship. 

cor(Penetration$`Wifi_Hotspots_Per_100,000`, Penetration$Population_Urban_Dec)

```
```{r}

scatterplot(Penetration$`Wifi_Hotspots_Per_100,000`, Penetration$Population_Urban_Dec, main = "Urban Population and Wifi Hotspots", ylab = "Urban Population(as decimal)", xlab = "Wifi Hotspots (per 100,000 inhabitants)")

#Graph needs ot be cleaned up
#There seems to be a couple of outliers but in general the very slightly negative sloping/non linear correlation (green line) is reflected here. 
```

```{r}
#We wanted to see if we could compare wifi hot spots per 100 inhabitants to penetration per 100 inhabitants. To do this we took the values for wifi per 100,000 inhabitants and divided by 1,000. It looks not have yeilded anything particularly helpful.  The transformation as applied to wifi_hotpots per 100,000 inhabitants was not helpful. I wonder if we need to apply a logarithmic trnasormation instead of simple division.

Wifi_hotspots_100 = Penetration$`Wifi_Hotspots_Per_100,000` / 1000

Wifi_compare = data.frame(Penetration$Country, Penetration$Penetration_OECD_2008, Wifi_hotspots_100)

Wifi_compare
```




# Be sure to describe any anomalies, coding issues, or potentially erroneous values. Explain how you respond to each issue you identify. 

# Note any features that appear relevant to statistical analysis. Discuss what transformations may be appropriate for each variable.
# Import and Process Speed CSV File


```{r}
Speed = read.csv("Speed.csv")
colnames(Speed) <- c('Country', 'Country_Code', 'Maximum_Advertised_kbps', 'Avg_Advertised_kbps', 'Avg_Actual_kbps', 'Avg_Download_kbps', 'SD_Download_kbps', 'Avg_Upload_kbps', 'SD_Upload_kbps', 'Avg_Latency', 'SD_Latency', 'Median_Download_kbps', 'Median_Upload_kbps', 'Median_Latency', 'X90_Download_kbps', 'X90_Upload_kbps', 'X10_Latency')
colnames(Speed)
```

# Join 3 Datasets together via full join. Join via Country Code because it's more standardized than Country (Eliminate mis-spelling and/or capitalized vs not-capitalized)
```{r}
library("dplyr")
join1 = full_join(Price, Penetration, by = c("Country_Code" ="Country_Code"))
Broadband = full_join(join1, Speed, by = c("Country_Code" ="Country_Code"))
head(Broadband)
```

 
```{r}
names(Broadband)
```


