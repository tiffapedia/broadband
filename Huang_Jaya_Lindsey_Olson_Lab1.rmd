---
title: "Broadband Exploration"
author: "Joanna Huang, Tiffany Jaya, David Lindsey, Aaron Olson"
output: pdf_document
---

# Introduction

## Our motivation
We are motivated to investigate the three-way relationship between price, speed, and penetration to see if there are any trade-off that exists between these concepts. By doing so, we can determine if countries that had not adopted some form of open access policies (such as United States, Mexico, and Slovak Republic) have network industry with better performance than other OECD countries that are regulated with open access policies. We use the metrics speed and penetration as a way to compare the performance of a network industry.

## Load dataset

```{r}
# include the packages
library(dplyr) 
library(moments) 
library(gridExtra)
library(car)
```

```{r}
# load the datasets
penetration <- read.csv('Penetration.csv')
price <- read.csv('Price.csv')
speed <- read.csv('Speed.csv')

# join the datasets
data <- inner_join(penetration, price, by=c("Country", "Country.Code"))
(data <- inner_join(data, speed, by=c("Country", "Country.Code"="Country.code")))
```

## Describe dataset

```{r}
str(data)
```

There are 30 observations of 33 variables. 

## Evaluate data quality

```{r}
summary(data)
```

For the Penetration dataset, we did not include the column with the header “X” because the entire column is filled with missing values represented by NA. 

For the Price dataset, there are missing values due to countries not having data for certain speeds. For instance, Belgium does not have data for its combined price for low speeds. Mexico and Turkey do not have data for their respective combined price for high speeds. Eleven countries do not have data for their respective combined price for very high speeds. 

```{r}
# list countries with missing value in column Price.for.low.speeds..combined
subset(data, data$Price.for.low.speeds..combined == '')$Country
# list countries with missing value in Price.for.high.speeds..combined
subset(data, data$Price.for.high.speeds..combined == '')$Country
# list countries with missing value in Price.for.very.high.speeds..combined
subset(data, data$Price.for.very.high.speeds..combined == '')$Country
```

For the speed dataset, we noted that there are four countries (Hungary, Poland, Slovak Republic, Turkey) that did not record their average actual speed, meaning we cannot take these observations into consideration. This is unfortunate because Slovak Republic is one of the three countries that does not adopt the open access policy.

```{r}
# list countries with missing value in Average.actual.speed..Akamai..kbps
subset(data, data$Average.actual.speed..Akamai..kbps. == '')$Country
```

Another interesting aspect to note is the apparent outliers that we can see from the data before we begin exploration. Poland has a percent urban population of 162% which doesn’t seem likely. Japan has a maximum advertised speed of 1,000,000 kbps which also doesn’t seem likely from the time the data is collected.

## Data processing or preparation

In order to perform any analysis on the variables, we have to convert several columns of type factors into type numeric.

```{r}
# Convert to double-precision values 

data$Price.for.low.speeds..combined <- as.numeric(gsub("[$,]", "", data$Price.for.low.speeds..combined))
data$Price.for.med.speeds..combined <- as.numeric(gsub("[$,]", "", data$Price.for.med.speeds..combined))
data$Price.for.high.speeds..combined <- as.numeric(gsub("[$,]", "", data$Price.for.high.speeds..combined))
data$Price.for.very.high.speeds..combined <- as.numeric(gsub("[$,]", "", data$Price.for.very.high.speeds..combined))

data$Maximum.advertised.speed.OECD..kbps. <- as.numeric(gsub(",", "", data$Maximum.advertised.speed.OECD..kbps.))
data$Average.advertised.speed.OECD..kbps. <- as.numeric(gsub(",", "", data$Average.advertised.speed.OECD..kbps.))
data$Average.actual.speed..Akamai..kbps. <- as.numeric(gsub(",", "", data$Average.actual.speed..Akamai..kbps.))
data$Average.download.speedtest.net..kbps. <- as.numeric(gsub(",", "", data$Average.download.speedtest.net..kbps.))
data$Standard.deviation.download..speedtest.net <- as.numeric(gsub(",", "", data$Standard.deviation.download..speedtest.net))
data$Average.upload.speedtest.net..kbps. <- as.numeric(gsub(",", "", data$Average.upload.speedtest.net..kbps.))
data$Standard.deviation.upload..speedtest.net <- as.numeric(gsub(",", "", data$Standard.deviation.upload..speedtest.net))
data$Standard.deviation.latency..speedtest.net <- as.numeric(gsub(",", "", data$Standard.deviation.latency..speedtest.net))
data$Median.download..speedtest.net..kbps. <- as.numeric(gsub(",", "", data$Median.download..speedtest.net..kbps.))
data$Median.upload..speedtest.net..kbps. <- as.numeric(gsub(",", "", data$Median.upload..speedtest.net..kbps.))
data$X90p..Download..speedtest.net..kbps. <- as.numeric(gsub(",", "", data$X90p..Download..speedtest.net..kbps.))
data$X90p..Upload..speedtest.net..kbps. <- as.numeric(gsub(",", "", data$X90p..Upload..speedtest.net..kbps.))
```

Since we wanted to compare countries who adopted the open access policies against those who don't, we can subset the data to reflect the two subsets.

```{r}
# countries that have not adopted open access policy: United States, Mexico, Slovak Republic
(non_open_countries <- subset(data, Country %in% c("United States", "Mexico", "Slovak Republic")))

# countries that adopted open access policy
(open_countries <- subset(data, !(Country %in% c("United States", "Mexico", "Slovak Republic"))))
```

# Univariate Analysis of Key Variables

## Penetration

## Price
```{r}
#Summary of Price Categories
summarise_each(data[, c("", "")])
```
Using the summary function, we can see that the Price increases with increased speed. Additionally, the mean price for the dataset lies between the two middle speed options (medium and high). A boxplot will help to better visualize the price data. 

```{r}
boxplot(Broadband[, 3:6], use.cols = TRUE, names = c("Low Speed", "Medium Speed", "High Speed", "Very High Speed"))
```

As would be expected, the higher speed broadband is correlated to higher price. What is noticed from the boxplot visualization is that the lower speeds tend to have a smaller standard deviation or spread (quartiles aren't spread out as much). 

```{r}
#Low Speed Standard Deviation
sd(Broadband$Price_LowSpeed, na.rm = TRUE)

#Medium Speed Standard Deviation
sd(Broadband$Price_MedSpeed, na.rm = TRUE)

#High Speed Standard Deviation
sd(Broadband$Price_HighSpeed, na.rm = TRUE)

#Very High Speed Standard Deviation
sd(Broadband$Price_VeryHighSpeed, na.rm = TRUE)
```

As can be observed, the two lower speed categories (low, medium) have an overall lower standard deviation, where the price range for high speed service is more variable. 

Presumably the evolution of high and very high speed networks are newer, and therefore not existent in every country, generating a NA datapoint in those countries where high/very high speed networks aren't available. From the column summaries previously posted, we see that there are between 2-4 missing datapoints per column in the low to high speed variables, but in the very high speed category, there are 13 missing variables.

It could be argued that in the countries where very high speed internet isn't available, the network as a whole is newer and perhaps more costly. In order to explore this, analyzing the mean price for low to medium speeds where very high speed isn't avialable could be enlightening. 

```{r}
subcases = is.na(Broadband$Price_VeryHighSpeed)

#Low Speed Mean Filtered Dataset:
mean(Broadband[subcases,]$Price_LowSpeed, na.rm = TRUE)
mean(Broadband[subcases,]$Price_LowSpeed, na.rm = TRUE) > mean(Broadband$Price_LowSpeed, na.rm = TRUE)

#Medium Speed Mean Filtered Dataset:
mean(Broadband[subcases,]$Price_MedSpeed, na.rm = TRUE)
mean(Broadband[subcases,]$Price_MedSpeed, na.rm = TRUE) > mean(Broadband$Price_MedSpeed, na.rm = TRUE)

#High Speed Mean Filtered Dataset:
mean(Broadband[subcases,]$Price_HighSpeed, na.rm = TRUE)
mean(Broadband[subcases,]$Price_HighSpeed, na.rm = TRUE) > mean(Broadband$Price_HighSpeed, na.rm = TRUE)
```
From our analysis, all instances where Very High Speed internet isn't available, the average price of the three other tiers is higher than the overall average for that class. 

```{r}
mapDevice('x11')
spdf <- joinCountryData2Map(Broadband, joinCode = "NAME", nameJoinColumn = "Country")
mapCountryData(spdf, nameColumnToPlot = "Price_MedSpeed", catMethod = "logFixedWidth", colourPalette = "topo")

```
Visualizing the data by map can help to see that price for broadband can be categorized by region. The majority of European countries have low cost Broadband service, with a few outliers. North America also appears on the lower end in terms of cost. Australia and the pacific have the highest price by region. 


## Speed
