---
title: "Broadband Exploration"
author: "Joanna Huang, Tiffany Jaya, David Lindsey, Aaron Olson"
output: pdf_document
---

# Introduction

## Our motivation
We are motivated to investigate the three-way relationship between price, speed, and penetration to see if there are any trade-off that exists between these concepts. By doing so, we can determine if countries that had not adopted some form of open access policies (such as United States, Mexico, and Slovak Republic) have network industry with better performance than other OECD countries that are regulated with open access policies. We use the metrics speed and penetration as a way to compare the performance of a network industry.

## Load dataset

We combine the three datasets by performing an inner join on country's name and code because if the country did not have a name or a respective code, it is not a valid country.

```{r global_options, include=FALSE}
library(knitr)
opts_chunk$set(tidy.opts=list(width.cutoff=60),tidy=TRUE)
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
```
```{r message=FALSE}
# include the packages
library(dplyr) 
library(moments) 
library(gridExtra)
library(rworldmap)
library(ggplot2)

# load the datasets
penetration <- read.csv('Penetration.csv')
price <- read.csv('Price.csv')
speed <- read.csv('Speed.csv')

# join the datasets
data <- inner_join(penetration, price, by=c("Country", "Country.Code"))
data <- inner_join(data, speed, by=c("Country", "Country.Code"="Country.code"))
```

## Describe dataset

```{r message=FALSE}
str(data)
```

There are 30 observations of 32 variables. 

## Evaluate data quality

```{r message=FALSE}
#summary(data)
```

For the Penetration dataset, we did not include the column with the header “X” because the entire column is filled with missing values represented by NA. 

For the Price dataset, there are missing values due to countries not having data for certain speeds. 
```{r message=FALSE}
# countries with missing value in column Price.for.low.speeds..combined:
subset(data, data$Price.for.low.speeds..combined == '' | is.na(data$Price.for.low.speeds..combined))$Country
# countries with missing value in column Price.for.high.speeds..combined:
subset(data, data$Price.for.high.speeds..combined == '' | is.na(data$Price.for.high.speeds..combined))$Country
# countries with missing value in column Price.for.very.high.speeds..combined:
subset(data, data$Price.for.very.high.speeds..combined == '' | is.na(data$Price.for.very.high.speeds..combined))$Country
```

For the speed dataset, we noted that there are four countries (Hungary, Poland, Slovak Republic, Turkey) that did not record their average actual speed, meaning we cannot take these observations into consideration. This is unfortunate because Slovak Republic is one of the three countries that does not adopt the open access policy.
```{r message=FALSE}
# countries with missing value in column Average.actual.speed..Akamai..kbps.:
subset(data, data$Average.actual.speed..Akamai..kbps. == '' | is.na(data$Average.actual.speed..Akamai..kbps.))$Country
```

Another interesting aspect to note is the apparent outliers that we can see from the data before we begin exploration. Poland has a percent urban population of 162% which doesn’t seem likely. Japan has a maximum advertised speed of 1,000,000 kbps which also doesn’t seem likely from the time the data is collected.

We also noticed that out of 30 countries, only three have not adopted an open access policy. It is pertinent to remember that we are working with a small dataset; therefore the sample may not represent the population.

## Data processing or preparation

In order to perform any analysis on the variables, we have to convert several columns of type factors into type numeric.

```{r message=FALSE}
# convert to double-precision values 
data$Growth.in.3G.penetration <- as.numeric(gsub("[%,]", "", data$Growth.in.3G.penetration))
data$Percent.of.population.in.urban.areas <- as.numeric(gsub("[%,]", "", data$Percent.of.population.in.urban.areas))
data$Price.for.low.speeds..combined <- as.numeric(gsub("[$,]", "", data$Price.for.low.speeds..combined))
data$Price.for.med.speeds..combined <- as.numeric(gsub("[$,]", "", data$Price.for.med.speeds..combined))
data$Price.for.high.speeds..combined <- as.numeric(gsub("[$,]", "", data$Price.for.high.speeds..combined))
data$Price.for.very.high.speeds..combined <- as.numeric(gsub("[$,]", "", data$Price.for.very.high.speeds..combined))
data$Maximum.advertised.speed.OECD..kbps. <- as.numeric(gsub(",", "", data$Maximum.advertised.speed.OECD..kbps.))
data$Average.advertised.speed.OECD..kbps. <- as.numeric(gsub(",", "", data$Average.advertised.speed.OECD..kbps.))
data$Average.actual.speed..Akamai..kbps. <- as.numeric(gsub(",", "", data$Average.actual.speed..Akamai..kbps.))
data$Average.download.speedtest.net..kbps. <- as.numeric(gsub(",", "", data$Average.download.speedtest.net..kbps.))
data$Standard.deviation.download..speedtest.net <- as.numeric(gsub(",", "", data$Standard.deviation.download..speedtest.net))
data$Average.upload.speedtest.net..kbps. <- as.numeric(gsub(",", "", data$Average.upload.speedtest.net..kbps.))
data$Standard.deviation.upload..speedtest.net <- as.numeric(gsub(",", "", data$Standard.deviation.upload..speedtest.net))
data$Standard.deviation.latency..speedtest.net <- as.numeric(gsub(",", "", data$Standard.deviation.latency..speedtest.net))
data$Median.download..speedtest.net..kbps. <- as.numeric(gsub(",", "", data$Median.download..speedtest.net..kbps.))
data$Median.upload..speedtest.net..kbps. <- as.numeric(gsub(",", "", data$Median.upload..speedtest.net..kbps.))
data$X90p..Download..speedtest.net..kbps. <- as.numeric(gsub(",", "", data$X90p..Download..speedtest.net..kbps.))
data$X90p..Upload..speedtest.net..kbps. <- as.numeric(gsub(",", "", data$X90p..Upload..speedtest.net..kbps.))
```

Since we wanted to compare countries who adopted the open access policies against those who don't, we can subset the data to reflect the two subsets.

```{r message=FALSE}
# countries that have not adopted open access policy: United States, Mexico, Slovak Republic
non_open_countries <- subset(data, Country %in% c("United States", "Mexico", "Slovak Republic"))
# countries that adopted open access policy
open_countries <- subset(data, !(Country %in% c("United States", "Mexico", "Slovak Republic")))
```

# Univariate Analysis of Key Variables

## Penetration

```{r message=FALSE}
summary(data[, which(names(data)=="Penetration.per.100.OECD..2008"):which(names(data)=="Percent.of.population.in.urban.areas")])
```
The summary statistics provide us the following insight about the penetration dataset:

* Any column header with “per.100” reflects the number of business and residential lines per 100 inhabitants (in the population) for each country. It is interesting to note that X2G.and.3G.penetration.per.100..OECD have values over 100. We can assume that carriers of mobile devices can flow from one population bloc of 100 inhabitants to another making the data more inflated than it actually is or 2G and 3G group counts a single individual twice if he/she had a mobile carrier that delivers both 2G and 3G, but further investigation is required to determine the cause.
* The date of variables in the dataset may be an unspoken factor, since the Penetration dataset includes information from 2008 and 2007.
* Growth.in.3G.penetration and Percent.of.population.in.urban.areas are in percent units instead of per 100 inhabitants.
* It is not clear whether Household.penetration..OECD are in percent units or in number per 100 inhabitants. We will assume that it is per 100 inhabitants.
* Wi.Fi.hotspots..JiWire values have a much higher range than all other variables. We assume this number may reflect the total number of WiFi hotspots available in a given country, rather than per 100 inhabitants.
* Penetration.per.100.OECD..2008 and Penetration.per.100.GC are close in distribution of values. We can assume that the two columns are collected in the same year by different groups, but further clarification is necessary as we do not know what the values of Penetration.per.100.GC represent.

```{r message=FALSE}
plot(data[,which(names(data)=="Penetration.per.100.OECD..2008"):which(names(data)=="Percent.of.population.in.urban.areas")])
```
The scatterplot matrix provides us insight that there is a positive relationship between Penetration.per.100.OECD..2008, Penetration.per.100.OECD..2007, Penetration.per.100.GC and Household.penetration..OECD. This plot suggests that these variables are closely related, which makes sense because they measure the penetration of businesses and residentials at a given period of time. 

We decided to look at the change of Penetration from 2007 to 2008 to see if there is penetration growth over the year. What we have found is that there was an increase in overall penetration. The only country that showed negative growth is Finland. 
```{r message=FALSE}
# format the data
pen2007 <- data.frame(group="2007", value=data$Penetration.per.100.OECD..2007)
pen2008 <- data.frame(group="2008", value=data$Penetration.per.100.OECD..2008)
pen <- rbind(pen2007, pen2008)

# plot
ggplot(pen, aes(x=group, y=value)) + 
  geom_boxplot() + 
  labs(title="Penetration in 2007 and 2008", x="", y="penetration per 100")
```
```{r message=FALSE}
Difference <- data$Penetration.per.100.OECD..2008 - data$Penetration.per.100.OECD..2007
cat(sprintf("Country with negative growth:\n%s: %g\n", data$Country[which(Difference < 0)], Difference[which(Difference < 0)]))
```

Next, we would like to compare the different types of penetration, assuming that Household.penetration..OECD reflects wired connections, X2G.and.3G.penetration.per.100..OECD and X3G.penetration.per.100 reflect mobile connections, and Wi.Fi.hotspots.per.100.000..JiWire reflect wireless connections. The graph below seems to reflect that mobile devices have a higher penetration followed by wired and wireless connection respectively, assuming that household values only take into consideration wired connection. We assume mobile penetration would have been higher since it does not include 4G connections and beyond.  
```{r message=FALSE}
# format the data
wired <-data.frame(group="wired",value=data$Household.penetration..OECD)
mobile2g3g <- data.frame(group="mobile 2G&3G", value=data$X2G.and.3G.penetration.per.100..OECD)
mobile3g <-data.frame(group="mobile 3G",value=data$X3G.penetration.per.100)
wireless <- data.frame(group="wireless", value=data$Wi.Fi.hotspots.per.100.000..JiWire)
pen_types <- rbind(wired, mobile2g3g, mobile3g, wireless)
# plot
ggplot(pen_types,aes(x=group, y=value)) +
  geom_boxplot() + 
  labs(title="Penetration by type", x="", y="penetration per 100")
```

To verify whether there is an increased growth rate in mobile penetration, we would compare the growth rate of penetration from 2007 to 2008 and the growth rate of 3G assuming it was also done in 2007 to 2008. From the graph below, the growth rate of 3G appears to be faster but we cannot draw any conclusions since we do not know when Growth.in.3G.penetration data are collected.

```{r message=FALSE}
data$Penetration_OECD_Growth <- (Difference/data$Penetration.per.100.OECD..2007)*100
general_growth <- data.frame(group="penetration in 2007-2008", value=data$Penetration_OECD_Growth )
mobile_growth <- data.frame(group="mobile 3G penetration", value=data$Growth.in.3G.penetration)
pen_growth <- rbind(general_growth, mobile_growth)
# plot
ggplot(pen_growth,aes(x=group, y=value)) +
  geom_boxplot() +
  labs(title="Penetration growth", x="", y="Percent")
```

### Consideration for lack of measurement details 
Given the lack of measurement details for the dataset, we do not know if the Household.penetration..OECD was measured in percentages or per 100 households. We assume it was per 100 households, but if it was in percentages, our outcomes based on this data are not accurate.

Also, for most of the penetration data, we do not know when the data is being recorded. 

Most penetration metrics are measured on a per household/inhabitat basis. This insight brings to question whether or not the measurement of penetration has more to do with population density vs absolute coverage. Intuitively a more densely populated area is more advantageous for a broadband company to establish service because there is a higher number of users per infrastructure. The United States is an outlier in the data, while it has a Wifi_Hotspot_Per_100000 that is within one standard deviation of the mean, it has a Wifi_Hotspot metric that is nearly ten times the category mean. Because of the size of the United States it has a high number of Wifi Hotspots.

## Price
Price is broken down by speed levels (low, medium, high and very high). 
```{r message=FALSE}
price_data <- data[, c("Price.for.low.speeds..combined", "Price.for.med.speeds..combined", "Price.for.high.speeds..combined", "Price.for.very.high.speeds..combined")]
summary(price_data)
```

Using the summary function, we can see that price seems to increase with increased speed. What is noticed from the  visualization below is that the lower speeds tend to have a smaller spread. It shows that the price range for higher speed service is more variable. 

```{r message=FALSE}
boxplot(price_data,
        las=1, # all axis labels horizontal
        names=c("low", "medium", "high", "very high"),
        main="Comparing price for different speeds",
        xlab="Speed",
        ylab="Price")
```
```{r message=FALSE}
# standard deviation for low speed
sd(data$Price.for.low.speeds..combined, na.rm = TRUE)
# standard deviation for medium speed
sd(data$Price.for.med.speeds..combined, na.rm = TRUE)
# standard deviation for high speed
sd(data$Price.for.high.speeds..combined, na.rm = TRUE)
# standard deviation for very high speed
sd(data$Price.for.very.high.speeds..combined, na.rm = TRUE)
```

Not every country has high and very high speed networks. There are more missing data points the faster the speed is: from 1 missing data point in low speed to 11 missing data points in very high speed. It could be argued that in countries where high or very high speed internet isn't available, the network as a whole is newer and perhaps more costly. In order to explore this, analyzing the mean price for low to medium speeds where very high speed isn't available could be enlightening. The reason why we chose very high speed is because countries that do not have data points for high speed also do not have data points for very high speed.

```{r message=FALSE}
na_very_high_speed <- data[is.na(data$Price.for.very.high.speeds..combined),]

sprintf("Is the low speed mean of the filtered dataset (%s) greater than the average low speed mean (%s)? %s",
        mean(na_very_high_speed$Price.for.low.speeds..combined, na.rm=TRUE),
        mean(data$Price.for.low.speeds..combined, na.rm=TRUE),
        mean(na_very_high_speed$Price.for.low.speeds..combined, na.rm=TRUE) >
             mean(data$Price.for.low.speeds..combined, na.rm=TRUE))
sprintf("Is the medium speed mean of the filtered dataset (%s) greater than the average medium speed mean (%s)? %s",
        mean(na_very_high_speed$Price.for.med.speeds..combined, na.rm=TRUE),
        mean(data$Price.for.med.speeds..combined, na.rm=TRUE),
        mean(na_very_high_speed$Price.for.med.speeds..combined, na.rm=TRUE) >
             mean(data$Price.for.med.speeds..combined, na.rm=TRUE))
# We understand that this will not include Mexico and Turkey
sprintf("Is the high speed mean of the filtered dataset (%s) greater than the average high speed mean (%s)? %s",
        mean(na_very_high_speed$Price.for.high.speeds..combined, na.rm=TRUE),
        mean(data$Price.for.high.speeds..combined, na.rm=TRUE),
        mean(na_very_high_speed$Price.for.high.speeds..combined, na.rm=TRUE) >
             mean(data$Price.for.high.speeds..combined, na.rm=TRUE))
```

From our analysis, all instances where Very High Speed internet isn't available, the average price of the three other tiers is higher than the overall average price for that class. 

The histogram of the price for medium speed (as well as low speed which we will not present here), reflects the positive skewness; there are more countries that will charge higher than the average for medium speed. 
```{r}
hist(data$Price.for.med.speeds..combined, main="Price for medium speed", xlab="price ($)")
skewness(data$Price.for.med.speeds..combined)
```


```{r message=FALSE}
mapDevice()
spdf <- joinCountryData2Map(data, joinCode = "NAME", nameJoinColumn = "Country")
mapParams <- mapCountryData(spdf, nameColumnToPlot = "Price.for.med.speeds..combined", catMethod = "logFixedWidth", colourPalette = "topo")
do.call(addMapLegend, c(mapParams))
```

Visualizing the data by map can help to see that price for broadband can be categorized by region. The majority of European countries have low cost Broadband service, with a few outliers. North America also appears on the lower end in terms of cost. Australia and the pacific have the highest price by region. 

### Consideration for lack of measurement details 
Given the lack of measurement details for the dataset, we are under the assumption that the price is based on the US dollar. We also assume that the price is converted from the country’s origin to US dollar; otherwise our analysis cannot be relied upon.

## Speed

We can begin to look at the advertised speed and compare that to the actual speed. As shown in the boxplot below, the advertised speed appears to be significantly higher than the actual speed. Interesting to note is the claim advertisement seems to promise for its maximum advertised speed, going so far as having an outlier of 1,000,000 kbps. It appears to be outside the scope of what the actual speed can deliver. It comes as no surprise that the histogram for maximum advertised speed appears to be more positively skewed in comparison to the histogram for average actual speed. In general, the maximum advertised speed and the average advertised speed have a wider spread due to their respective standard deviation being larger than the average actual speed; it can be assumed that advertisements are not limited by actual hardware limitations in terms of claimed speed. 

```{r message=FALSE}
# format the data
max_ad_speed <- data.frame(group="max ad", value=data$Maximum.advertised.speed.OECD..kbps.)
avg_ad_speed <- data.frame(group="avg ad", value=data$Average.advertised.speed.OECD..kbps.)
avg_actual_speed <- data.frame(group="avg actual", value=data$Average.actual.speed..Akamai..kbps.)
ad_speed <- rbind(max_ad_speed, avg_ad_speed, avg_actual_speed)

# plot
w_outliers <- ggplot(ad_speed,
                     aes(x=group, y=value)) + 
              geom_boxplot() + 
              labs(title="with outliers", x="", y="Speed (kbps)")

# compute lower and upper whisker limits
max_ad_speed_wo_outliers <- data$Maximum.advertised.speed.OECD..kbps.[!data$Maximum.advertised.speed.OECD..kbps. %in% boxplot.stats(data$Maximum.advertised.speed.OECD..kbps.)$out]
avg_ad_speed_wo_outliers <- data$Average.advertised.speed.OECD..kbps.[!data$Average.advertised.speed.OECD..kbps. %in% boxplot.stats(data$Average.advertised.speed.OECD..kbps.)$out]
avg_actual_speed_wo_outliers <- data$Average.actual.speed..Akamai..kbps.[!data$Average.actual.speed..Akamai..kbps. %in% boxplot.stats(data$Average.actual.speed..Akamai..kbps.)$out]
upper_limit <- max(max_ad_speed_wo_outliers, avg_ad_speed_wo_outliers, avg_actual_speed_wo_outliers, na.rm=TRUE)
lower_limit <- min(max_ad_speed_wo_outliers, avg_ad_speed_wo_outliers, avg_actual_speed_wo_outliers, na.rm=TRUE)

# plot
wo_outliers <- ggplot(ad_speed,
                      aes(x=group, y=value)) + 
               geom_boxplot(outlier.shape=NA) + 
               labs(title="without outliers", x="", y="Speed (kbps)") + 
               coord_cartesian(ylim=c(lower_limit, upper_limit))

grid.arrange(w_outliers, wo_outliers, ncol=2, top="Comparing advertised vs actual speed")
```

```{r message=FALSE}
max_h <- ggplot(data=data, 
                aes(data$Maximum.advertised.speed.OECD..kbps.)) + 
         geom_histogram() + 
         labs(title="max advertised", x="")

avg_h <- ggplot(data=data,
                aes(data$Average.advertised.speed.OECD..kbps.)) + 
         geom_histogram() + 
         labs(title="avg advertised", x="")

act_h <- ggplot(data=data,
                aes(data$Average.actual.speed..Akamai..kbps.)) + 
         geom_histogram() + 
         labs(title="avg actual", x="")
grid.arrange(max_h, avg_h, act_h, ncol=3, top="Histograms of advertised vs actual speed")
```

What would be interesting to determine is to see if the advertised speed would be significantly higher in countries that do not adopt open source policies compared to countries that do. Although we have verified that outliers such as Japan and Korea have faster internet speed in general, we removed them while creating the boxplot for better visual clarity. What we have found out is that although countries that do not adopt open access policy do not appear to advertise internet speed higher than the other OECD countries, they do in general have a lower average actual speed. The data is not thoroughly conclusive as Slovak Republic does not have its actual average speed reported.  

```{r message=FALSE}
# Countries that adopt open access policy:
# Number of outliers for average advertised speed: 
subset(data, Average.advertised.speed.OECD..kbps. %in%         
       boxplot.stats(open_countries$Average.advertised.speed.OECD..kbps.)$out)$Country
# Number of outliers for average advertised speed: ",
subset(data, Average.actual.speed..Akamai..kbps. %in%
       boxplot.stats(open_countries$Average.actual.speed..Akamai..kbps.)$out)$Country

# Countries that do not adopt open access policy:
# Number of outliers for average advertised speed:
length(boxplot.stats(non_open_countries$Average.advertised.speed.OECD..kbps.)$out)
# Number of outliers for average advertised speed:  
length(boxplot.stats(non_open_countries$Average.actual.speed..Akamai..kbps.)$out)
```


```{r message=FALSE}
# format the data
avg_ad_speed <- data.frame(group="avg ad", value=open_countries$Average.advertised.speed.OECD..kbps.)
avg_actual_speed <- data.frame(group="avg actual", value=open_countries$Average.actual.speed..Akamai..kbps.)
o_ad_speed <- rbind(avg_ad_speed, avg_actual_speed)

avg_ad_speed <- data.frame(group="avg ad", value=non_open_countries$Average.advertised.speed.OECD..kbps.)
avg_actual_speed <- data.frame(group="avg actual", value=non_open_countries$Average.actual.speed..Akamai..kbps.)
no_ad_speed <- rbind(avg_ad_speed, avg_actual_speed)

# compute lower and upper whisker limits
o_avg_ad_speed_wo_outliers <- open_countries$Average.advertised.speed.OECD..kbps.[!open_countries$Average.advertised.speed.OECD..kbps. %in% boxplot.stats(open_countries$Average.advertised.speed.OECD..kbps.)$out]
o_avg_actual_speed_wo_outliers <- open_countries$Average.actual.speed..Akamai..kbps.[!open_countries$Average.actual.speed..Akamai..kbps. %in% boxplot.stats(open_countries$Average.actual.speed..Akamai..kbps.)$out]

no_avg_ad_speed_wo_outliers <- non_open_countries$Average.advertised.speed.OECD..kbps.[!non_open_countries$Average.advertised.speed.OECD..kbps. %in% boxplot.stats(non_open_countries$Average.advertised.speed.OECD..kbps.)$out]
no_avg_actual_speed_wo_outliers <- non_open_countries$Average.actual.speed..Akamai..kbps.[!non_open_countries$Average.actual.speed..Akamai..kbps. %in% boxplot.stats(non_open_countries$Average.actual.speed..Akamai..kbps.)$out]

upper_limit <- max(o_avg_ad_speed_wo_outliers, o_avg_actual_speed_wo_outliers, 
                   no_avg_ad_speed_wo_outliers, no_avg_actual_speed_wo_outliers, na.rm=TRUE)
lower_limit <- min(o_avg_ad_speed_wo_outliers, o_avg_actual_speed_wo_outliers, 
                   no_avg_ad_speed_wo_outliers, no_avg_actual_speed_wo_outliers, na.rm=TRUE)

boxplot_o <- ggplot(o_ad_speed,
                    aes(x=group, y=value)) + 
             geom_boxplot(outlier.shape=NA) + 
             labs(title="open policy without outliers", x="", y="Speed (kbps)") + 
             coord_cartesian(ylim=c(lower_limit, upper_limit))

boxplot_no <- ggplot(no_ad_speed,
                     aes(x=group, y=value)) + 
              geom_boxplot(outlier.shape=NA) + 
              labs(title="non-open policy without outliers", x="", y="Speed (kbps)") + 
              coord_cartesian(ylim=c(lower_limit, upper_limit))
 
grid.arrange(boxplot_o, boxplot_no, ncol=2, top="Comparing advertised vs actual speed")
```

The mean of the average download speedtest is higher than the median download speedtest, which tells us that the download speed might be positively skewed. The same can be said for latency and upload speed. In this aspect, countries that adopt open access policy do not seem to differ from countries that do not adopt open access policy.

We can roughly estimate that upload speed have more variability than latency which in turn has more variability than download speed, but without the full data to verify, this is just a rough estimate based on comparing the standard deviation to the mean. Again, in this aspect, countries that adopt open access policy do not seem to differ from countries that do not adopt open access policy.

### Consideration for lack of measurement details 
Given the lack of measurement details for the dataset, we decided to skip X90p..Download..speedtest.net..kbps., X90p..Upload..speedtest.net..kbps., and X10p..Latency..speedtest.net as we cannot be certain what these data measure. 
Another important aspect to note is how the average actual speed is measured because we do not know for certain if the speed collected reflects 3G speed, WiFi speed, Fiber speed, etc. or all of the above. We also do not know if the average actual speed reflects the download, upload, and latency or just the download speed for example. Also, based on the column header’s name, we do not know how Akamai collect its speed data in comparison to speedtest.net. For this reason, we cannot be certain if the relationships reflected in the analysis are valid unless we are able to explore more on the dataset’s definition of average actual speed.

We also removed outliers in our univariate analysis of speed because we are not certain if the values reflected are the actual or simply bolstered speed. Because we removed these outliers, if the outliers are indeed actual speed reflected in the country, our analysis will reflect speed that is much slower than actual.

# Analysis of Key Relationships

Network owners in US argue that adopting open access policies will create a trade-off between price, speed, and penetration. For this reason, we will look at the countries that do not adopt open access policies and see if the speed and penetration are reflectively better than countries that do not.

We will look into the most recent penetration data Penetration.per.100.OECD..2008, which reflects both businesses and residences before diving in to penetration data in household (Household.penetration..OECD), in mobile 3G (X3G.penetration.per.100), and in WiFi hotspots (Wi.Fi.hotspots.per.100.000..JiWire). We will compare them to the average actual speed (Average.actual.speed..Akamai..kbps) in addition to average and median upload speed(Average.upload.speedtest.net..kbps, Median.upload..speedtest.net..kbps), average and median download speed (Average.download.speedtest.net..kbps, Median.download.speedtest.net..kbps), and latency (Median.latency..speedtest.net).

Then, we will look at the relationship of penetration and  price for medium speed as well as speed and price for medium speed since the data for price for medium speed is most complete. (Price.for.med.speeds..combined).

## Penetration and Speed
Looking at Penetration vs. Speed we wanted to explore what impacts penetration had on speed and what relationships if any existed between the two. For the purposes of this bivariate analysis we looked at the most recent Penetration OECD data (2008). 

We began by looking at correlation coefficients for penetration variables for: 100 inhabitants in 2008, household OECD, mobile 3G, and wifi hotpots and speed variabes for: average actual speed, average and median download speeds, average and median upload speeds, and latency.

```{r message=FALSE}
correlations <- c("Penetration.per.100.OECD..2008", "Household.penetration..OECD", "X3G.penetration.per.100", "Wi.Fi.hotspots..JiWire", "Average.actual.speed..Akamai..kbps.", "Average.download.speedtest.net..kbps.", "Median.download..speedtest.net..kbps.", "Average.upload.speedtest.net..kbps.", "Median.upload..speedtest.net..kbps.", "Average.latency.speedtest.net", "Median.latency..speedtest.net"  )

pen_speed <- data[correlations]
pen_speed_cor = cor(pen_speed, use= "complete.obs") 
view1 = pen_speed_cor[c("Penetration.per.100.OECD..2008", "Household.penetration..OECD", "X3G.penetration.per.100", "Wi.Fi.hotspots..JiWire"),] 
view1

```

Looking at the correlations table we see there are several correlation coefficients for speed and penetration variables that are greater than 0.5, an indication of a relatively strong positive relationship, namely household penetration and actual speed (0.61524195) , household penetration and average download speed (0.6341508) as well as median download speed(0.6041662), penetration and median download speed (0.504467). Most noteably correlations between household penetration and download speeds is greater than penetration per 100 inhabitants. This may be because the household penetration includes businesses (and reflected a higher distribution relative to penetration per 100 inhabitants).   

There are also relatively moderate (between 0.3 and 0.5) positive correlations for penetration (per inhabitants and household) and average and median upload speeds. The only negative correlations between our selected penetration variables and speed variables is for latency (or lag). Interestingly higher penetration correlates with lower latency.

```{r}
g1 <- ggplot(data, 
             aes(x=Penetration.per.100.OECD..2008, y=Average.actual.speed..Akamai..kbps., label=Country.Code)) +
      geom_point(data=open_countries) +
      geom_point(data=non_open_countries, color="red") + 
      geom_smooth() + 
      geom_text(data=non_open_countries, hjust=-1, vjust=1) + 
      labs(title="Penetration vs Speed", 
           x="penetration per 100 inhabitants", 
           y="average actual speed (kbps)")
g2 <- ggplot(data, 
             aes(x=Household.penetration..OECD, y=Average.actual.speed..Akamai..kbps., label=Country.Code)) +
      geom_point(data=open_countries) +
      geom_point(data=non_open_countries, color="red") + 
      geom_smooth() + 
      geom_text(data=non_open_countries, hjust=-1, vjust=1) +
      labs(title="Household Penetration vs Speed", 
           x="penetration (per 100 inhabitants, assuming)", 
           y="average actual speed (kbps)")
g3 <- ggplot(data, 
             aes(x=X3G.penetration.per.100, y=Average.actual.speed..Akamai..kbps., label=Country.Code)) +
      geom_point(data=open_countries) +
      geom_point(data=non_open_countries, color="red") + 
      geom_smooth() + 
      geom_text(data=non_open_countries, hjust=-1, vjust=1) +
      labs(title="3G Penetration vs Speed", 
           x="penetration per 100 inhabitants", 
           y="average actual speed (kbps)")
  
g4 <- ggplot(data, 
             aes(x=Wi.Fi.hotspots.per.100.000..JiWire, y=Average.actual.speed..Akamai..kbps., label=Country.Code)) +
      geom_point(data=open_countries) +
      geom_point(data=non_open_countries, color="red") + 
      geom_smooth() + 
      geom_text(data=non_open_countries, hjust=-1, vjust=1) +
      labs(title="WiFi Hotspots Penetration vs Speed", 
           x="penetration per 100 inhabitants", 
           y="average actual speed (kbps)")

grid.arrange(g1, g2, g3, g4, ncol=2, top="Bivariate analysis of penetration and average actual speed")
```


```{r message=FALSE}

g1 <- ggplot(data, 
             aes(x=Penetration.per.100.OECD..2008, y=Median.download..speedtest.net..kbps., label=Country.Code)) +
      geom_point(data=open_countries) +
      geom_point(data=non_open_countries, color="red") + 
      geom_smooth() + 
      geom_text(data=non_open_countries, hjust=-1, vjust=1) + 
      labs(title="Penetration vs Download Speed", 
           x="penetration per 100 inhabitants", 
           y="median download speed (kbps)")
g2 <- ggplot(data, 
             aes(x=Penetration.per.100.OECD..2008, y=Median.upload..speedtest.net..kbps., label=Country.Code)) +
      geom_point(data=open_countries) +
      geom_point(data=non_open_countries, color="red") + 
      geom_smooth() + 
      geom_text(data=non_open_countries, hjust=-1, vjust=1) +
      labs(title="Penetration vs Upload Speed", 
            x="penetration per 100 inhabitants", 
           y="median upload speed (kbps)")
g3 <- ggplot(data, 
             aes(x=Penetration.per.100.OECD..2008, y=Median.latency..speedtest.net, label=Country.Code)) +
      geom_point(data=open_countries) +
      geom_point(data=non_open_countries, color="red") + 
      geom_smooth() + 
      geom_text(data=non_open_countries, hjust=-1, vjust=1) +
      labs(title="Penetration vs Lag", 
           x="penetration per 100 inhabitants", 
           y="median latency (kbps)")
  
grid.arrange(g1, g2, g3, ncol=2, top="Bivariate analysis of penetration and speed variables")


```

We might deduce from these correlations a general trend for penetration and speed that reflects countries with relatively higher penetration also having relatively higher internet speeds in all benchmarks (downloads, uploads, latency, and actual speed tests) with few outliers. Whether this is a feature of open-access policies remains to be seen. 

```{r message=FALSE}
g1 <- ggplot(data, 
             aes(x=Penetration.per.100.OECD..2008, y=Average.actual.speed..Akamai..kbps., label=Country.Code)) +
      geom_point(data=open_countries) +
      geom_point(data=non_open_countries, color="red") + 
      geom_smooth() + 
      geom_text(data=non_open_countries, hjust=-1, vjust=1) + 
      labs(title="Penetration vs Speed", 
           x="penetration per 100 inhabitants", 
           y="average actual speed (kbps)")
g2 <- ggplot(data, 
             aes(x=Household.penetration..OECD, y=Average.actual.speed..Akamai..kbps., label=Country.Code)) +
      geom_point(data=open_countries) +
      geom_point(data=non_open_countries, color="red") + 
      geom_smooth() + 
      geom_text(data=non_open_countries, hjust=-1, vjust=1) +
      labs(title="Household Penetration vs Speed", 
           x="penetration (per 100 inhabitants, assuming)", 
           y="average actual speed (kbps)")
g3 <- ggplot(data, 
             aes(x=X3G.penetration.per.100, y=Average.actual.speed..Akamai..kbps., label=Country.Code)) +
      geom_point(data=open_countries) +
      geom_point(data=non_open_countries, color="red") + 
      geom_smooth() + 
      geom_text(data=non_open_countries, hjust=-1, vjust=1) +
      labs(title="3G Penetration vs Speed", 
           x="penetration per 100 inhabitants", 
           y="average actual speed (kbps)")
  
g4 <- ggplot(data, 
             aes(x=Wi.Fi.hotspots.per.100.000..JiWire, y=Average.actual.speed..Akamai..kbps., label=Country.Code)) +
      geom_point(data=open_countries) +
      geom_point(data=non_open_countries, color="red") + 
      geom_smooth() + 
      geom_text(data=non_open_countries, hjust=-1, vjust=1) +
      labs(title="WiFi Hotspots Penetration vs Speed", 
           x="penetration per 100 inhabitants", 
           y="average actual speed (kbps)")

grid.arrange(g1, g2, g3, g4, ncol=2, top="Bivariate analysis of penetration and average actual speed")
```
According to the graphs above, Mexico is relatively lower than all countries across all variables, including penetration per household, 3G penetration and number of WiFi hotspots. The U.S. is around the middle for all variables except WiFi hotspots.

```{r message=FALSE}
with(data, cor(Penetration.per.100.OECD..2008, Average.actual.speed..Akamai..kbps., use="pairwise.complete.obs"))
with(data, cor(Household.penetration..OECD, Average.actual.speed..Akamai..kbps., use="pairwise.complete.obs"))
with(data, cor(X3G.penetration.per.100, Average.actual.speed..Akamai..kbps., use="pairwise.complete.obs"))
with(data, cor(Wi.Fi.hotspots.per.100.000..JiWire, Average.actual.speed..Akamai..kbps., use="pairwise.complete.obs"))
```
Overall, there appears to be a positive correlation between Penetration.per.100.OECD..2008, House- hold.penetration..OECD, X3G.penetration.per.100 and Wi.Fi.hotspots.per.100.000 and speed, with the correlation being highest between Household Penetration and Average actual speed.

In conclusion, countries with higher penetration also have relatively higher internet speeds and lower latency in general. Since we have two to three datasets to work with for Non Open-Access countries, we cannot conclude whether or not open access policies enables higher penetration and faster speed. US appears to be on the average in terms of penetration and speed while Mexico and Slovak Republic seem to be trailing behind in terms of both. 

## Penetration and Price

```{r message=FALSE}
g1 <- ggplot(data, 
             aes(x=Penetration.per.100.OECD..2008, y=Price.for.med.speeds..combined, label=Country.Code)) +
      geom_point(data=open_countries) +
      geom_point(data=non_open_countries, color="red") + 
      geom_smooth() + 
      geom_text(data=non_open_countries, hjust=-1, vjust=1) + 
      labs(title="Penetration vs Price", 
           x="penetration per 100 inhabitants", 
           y="price for medium speed")
g2 <- ggplot(data, 
             aes(x=Household.penetration..OECD, y=Price.for.med.speeds..combined, label=Country.Code)) +
      geom_point(data=open_countries) +
      geom_point(data=non_open_countries, color="red") + 
      geom_smooth() + 
      geom_text(data=non_open_countries, hjust=-1, vjust=1) +
      labs(title="Household Penetration vs Price", 
           x="penetration (per 100 inhabitants, assuming)", 
           y="price for medium speed")
g3 <- ggplot(data, 
             aes(x=X3G.penetration.per.100, y=Price.for.med.speeds..combined, label=Country.Code)) +
      geom_point(data=open_countries) +
      geom_point(data=non_open_countries, color="red") + 
      geom_smooth() + 
      geom_text(data=non_open_countries, hjust=-1, vjust=1) +
      labs(title="3G Penetration vs Price", 
           x="penetration per 100 inhabitants", 
           y="price for medium speed")
  
g4 <- ggplot(data, 
             aes(x=Wi.Fi.hotspots.per.100.000..JiWire, y=Price.for.med.speeds..combined, label=Country.Code)) +
      geom_point(data=open_countries) +
      geom_point(data=non_open_countries, color="red") + 
      geom_smooth() + 
      geom_text(data=non_open_countries, hjust=-1, vjust=1) +
      labs(title="WiFi Hotspots Penetration vs Price", 
           x="penetration per 100 inhabitants", 
           y="price for medium speed")

grid.arrange(g1, g2, g3, g4, ncol=2, top="Bivariate analysis of penetration and price for medium speed")
```
In terms of price, Mexico again with its low value of penetration, has among the top 3 most expensive prices for medium speed.

Slovak Rep. and the U.S. seem to have penetration and price values around the middle for penetration per household and 3G penetration. U.S. has a higher penetration and wifi penetration per 100 inhabitants, but its price seems to remain within $10 of Slovak Rep.'s prices.
```{r message=FALSE}
with(data, cor(Penetration.per.100.OECD..2008, Price.for.med.speeds..combined, use="pairwise.complete.obs"))
with(data, cor(Household.penetration..OECD, Price.for.med.speeds..combined, use="pairwise.complete.obs"))
with(data, cor(X3G.penetration.per.100, Price.for.med.speeds..combined, use="pairwise.complete.obs"))
with(data, cor(Wi.Fi.hotspots.per.100.000..JiWire, Price.for.med.speeds..combined, use="pairwise.complete.obs"))
```
Overall, there appears to be a negative correlation between Penetration.per.100.OECD..2008, Household.penetration..OECD, X3G.penetration.per.100 and Wi.Fi.hotspots.per.100.000 and price for medium speed, with the negative correlation being highest between Penetration.per.100.OECD..2008 and Price for Medium Speed. 
 
```{r message=FALSE}
with(open_countries, cor(Penetration.per.100.OECD..2008, Price.for.med.speeds..combined, use="pairwise.complete.obs"))
with(open_countries, cor(Household.penetration..OECD, Price.for.med.speeds..combined, use="pairwise.complete.obs"))
with(open_countries, cor(X3G.penetration.per.100, Price.for.med.speeds..combined, use="pairwise.complete.obs"))
with(open_countries, cor(Wi.Fi.hotspots.per.100.000..JiWire, Price.for.med.speeds..combined, use="pairwise.complete.obs"))

with(non_open_countries, cor(Penetration.per.100.OECD..2008, Price.for.med.speeds..combined, use="pairwise.complete.obs"))
with(non_open_countries, cor(Household.penetration..OECD, Price.for.med.speeds..combined, use="pairwise.complete.obs"))
with(non_open_countries, cor(X3G.penetration.per.100, Price.for.med.speeds..combined, use="pairwise.complete.obs"))
with(non_open_countries, cor(Wi.Fi.hotspots.per.100.000..JiWire, Price.for.med.speeds..combined, use="pairwise.complete.obs"))

```
When comparing the correlation between the Penetration variables and Price for Medium Speeds for Open-Access and Non Open-Access countries, there seems to be a higher negative correlation for Non-Open Access countries. However, these results may be due to the limited dataset, 

## Speed and Price

Intuitively higher price should correlate with higher speed. We set out to explore this relationship. 

```{r}
boxplot(price_data,
        las=1, # all axis labels horizontal
        names=c("low", "medium", "high", "very high"),
        main="Comparing price for different speeds",
        xlab="Speed",
        ylab="Price")
```

From the boxplot, analysis of the means shows that higher prices correlate with higher speed. As mentioned in univariate analysis, the two higher speed categories have a larger range of prices when compared to the low speed price data. 

```{r message=FALSE}
ggplot(data, 
       aes(x=Average.actual.speed..Akamai..kbps., y=Price.for.med.speeds..combined, label=Country.Code)) +
geom_point(data=open_countries) +
geom_point(data=non_open_countries, color="red") + 
geom_smooth() + 
geom_text(data=non_open_countries, hjust=-1, vjust=1) + 
labs(title="Bivariate analysis of average actual speed and price for medium speed", 
     x="speed (kbps)", 
     y="price for medium speed ($, assuming)")
```

The price variables within the dataset are associated with a speed category (low, medium, high and very high). The scatterplot above displays the actual speed vs medium-speed price variable. In general, higher speeds correlate with a lower price. Intuitively this is the opposite of what is to be expected and what was discovered in the boxplot (high speed correlates with highe price). However the scatterplot only uses one price category (medium) and compares over the actual speed dataset. The dataset provided did not clearly state how many kbps were considered in each of the price categories. This makes copmaring speed vs price more complicated as the specific speed within the "medium speed price" level per country is not given. 

```{r message=FALSE}
with(data, cor(Average.actual.speed..Akamai..kbps., Price.for.med.speeds..combined, use="pairwise.complete.obs"))
sum(is.na(non_open_countries$Average.actual.speed..Akamai..kbps.))
sum(is.na(non_open_countries$Price.for.med.speeds..combined))
```
There is a weak negative correlation between the medium speed price and speed. One interpretation in order to explain the negative correlation, is that more established broadband networks offer higher speeds, and competition within the country drives down the price. This hypothesis is supported by the negative correlation from before between price and penetration. Further analysis would require the explicit speed within the various price categories. 

From the boxplot analysis, higher price correlates with higher speed. While the scatterplot appears to contradict these findings, because explicit speed per price category was not given, the analysis can not be completed. 


# Analysis of Secondary Effects

In addition to the lack of measurement details we discussed earlier, we felt that the secondary variables, infrastructure gap and monopolization, might have confounding effects on the relationships we identified.

The current dataset fails to account for existing infrastructure inequalities between developed and developing countries, which skews our understanding of variables, specifically when looking at growth for penetration (both general and 3G). For example, looking at the difference in penetration growth between 2007 and 2008, Mexico greatly exceeds that of any other countries, while Iceland had the lowest growth, not including Finland. The former is a developing country that may be catching up, while the latter is a developed country with potentially more established and advanced infrastructure. However, they are in in this analyses, compared within the same bracket.

Additionally, monopolization may have affected the relationships we identified. If a country has most of their network infrastructure monopolized by a company, the price may be higher, which may be the case for developing countries where monopolization offenses are not regulated by law.

# Conclusion

In summary, the key relationships that we observed from our exploratory analysis were a positive correlation between a country's penetration variables and average actual speed offered and a negative correlation with price for medium speed.

As expected, higher speeds corresponded to higher price. Greater penetration also reflected higher actual speeds in addition to higher tested download and upload speeds.

Comparing countries who have adopted an open access policy to those who have not, in 82% of the categories measured in the dataset, the Open Access countries had a superior mean. Superior is interpreted to be high speed, larger penetration and smaller price variables. As previously mentioned, conclusive analysis cannot be carried out due to the limited size of the Non-Open Access dataset. However, from the analysis performed, Open Access Countries appear to provide superior Broadband metrics to their citizens. 
