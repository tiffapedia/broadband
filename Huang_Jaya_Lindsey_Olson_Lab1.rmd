---
title: "Broadband Exploration"
author: "Joanna Huang, Tiffany Jaya, David Lindsey, Aaron Olson"
output: pdf_document
---

# Introduction

## Our motivation
We are motivated to investigate the three-way relationship between price, speed, and penetration to see if there are any trade-off that exists between these concepts. By doing so, we can determine if countries that had not adopted some form of open access policies (such as United States, Mexico, and Slovak Republic) have network industry with better performance than other OECD countries that are regulated with open access policies. We use the metrics speed and penetration as a way to compare the performance of a network industry.

## Load dataset

```{r}
# include the packages
library(dplyr) 
library(moments) 
library(gridExtra)
library(car)
library(rworldmap)
library(ggplot2)
```

```{r}
# load the datasets
penetration <- read.csv('Penetration.csv')
price <- read.csv('Price.csv')
speed <- read.csv('Speed.csv')

# join the datasets
data <- inner_join(penetration, price, by=c("Country", "Country.Code"))
data <- inner_join(data, speed, by=c("Country", "Country.Code"="Country.code"))
```

## Describe dataset

```{r}
str(data)
```

There are 30 observations of 33 variables. 

## Evaluate data quality

```{r}
summary(data)
```
```{r}
summary(data)
```


For the Penetration dataset, we did not include the column with the header “X” because the entire column is filled with missing values represented by NA. 

For the Price dataset, there are missing values due to countries not having data for certain speeds. For instance, Belgium does not have data for its combined price for low speeds. Mexico and Turkey do not have data for their respective combined price for high speeds. Eleven countries do not have data for their respective combined price for very high speeds. 

```{r}
cat("Countries with missing value in column Price.for.low.speeds..combined:",
    subset(data, data$Price.for.low.speeds..combined == '' | is.na(data$Price.for.low.speeds..combined))$Country,
    "\n",
    sep="\n* ")

cat("Countries with missing value in column Price.for.high.speeds..combined:", 
    subset(data, data$Price.for.high.speeds..combined == '' | is.na(data$Price.for.high.speeds..combined))$Country,
    "\n",
    sep="\n* ")

cat("Countries with missing value in column Price.for.very.high.speeds..combined:", 
    subset(data, data$Price.for.very.high.speeds..combined == '' | is.na(data$Price.for.very.high.speeds..combined))$Country,
    "\n",
    sep="\n* ")
```

For the speed dataset, we noted that there are four countries (Hungary, Poland, Slovak Republic, Turkey) that did not record their average actual speed, meaning we cannot take these observations into consideration. This is unfortunate because Slovak Republic is one of the three countries that does not adopt the open access policy.

```{r}
cat("Countries with missing value in column Average.actual.speed..Akamai..kbps.: ", 
    subset(data, data$Average.actual.speed..Akamai..kbps. == '' | is.na(data$Average.actual.speed..Akamai..kbps.))$Country,
    "\n",
    sep="  ")
```

Another interesting aspect to note is the apparent outliers that we can see from the data before we begin exploration. Poland has a percent urban population of 162% which doesn’t seem likely. Japan has a maximum advertised speed of 1,000,000 kbps which also doesn’t seem likely from the time the data is collected.

## Data processing or preparation

In order to perform any analysis on the variables, we have to convert several columns of type factors into type numeric.

```{r}
# Convert to double-precision values 
data$Growth.in.3G.penetration <- as.numeric(gsub("[%,]", "", data$Growth.in.3G.penetration))
data$Percent.of.population.in.urban.areas <- as.numeric(gsub("[%,]", "", data$Percent.of.population.in.urban.areas))

data$Price.for.low.speeds..combined <- as.numeric(gsub("[$,]", "", data$Price.for.low.speeds..combined))
data$Price.for.med.speeds..combined <- as.numeric(gsub("[$,]", "", data$Price.for.med.speeds..combined))
data$Price.for.high.speeds..combined <- as.numeric(gsub("[$,]", "", data$Price.for.high.speeds..combined))
data$Price.for.very.high.speeds..combined <- as.numeric(gsub("[$,]", "", data$Price.for.very.high.speeds..combined))

data$Maximum.advertised.speed.OECD..kbps. <- as.numeric(gsub(",", "", data$Maximum.advertised.speed.OECD..kbps.))
data$Average.advertised.speed.OECD..kbps. <- as.numeric(gsub(",", "", data$Average.advertised.speed.OECD..kbps.))
data$Average.actual.speed..Akamai..kbps. <- as.numeric(gsub(",", "", data$Average.actual.speed..Akamai..kbps.))
data$Average.download.speedtest.net..kbps. <- as.numeric(gsub(",", "", data$Average.download.speedtest.net..kbps.))
data$Standard.deviation.download..speedtest.net <- as.numeric(gsub(",", "", data$Standard.deviation.download..speedtest.net))
data$Average.upload.speedtest.net..kbps. <- as.numeric(gsub(",", "", data$Average.upload.speedtest.net..kbps.))
data$Standard.deviation.upload..speedtest.net <- as.numeric(gsub(",", "", data$Standard.deviation.upload..speedtest.net))
data$Standard.deviation.latency..speedtest.net <- as.numeric(gsub(",", "", data$Standard.deviation.latency..speedtest.net))
data$Median.download..speedtest.net..kbps. <- as.numeric(gsub(",", "", data$Median.download..speedtest.net..kbps.))
data$Median.upload..speedtest.net..kbps. <- as.numeric(gsub(",", "", data$Median.upload..speedtest.net..kbps.))
data$X90p..Download..speedtest.net..kbps. <- as.numeric(gsub(",", "", data$X90p..Download..speedtest.net..kbps.))
data$X90p..Upload..speedtest.net..kbps. <- as.numeric(gsub(",", "", data$X90p..Upload..speedtest.net..kbps.))
```

Since we wanted to compare countries who adopted the open access policies against those who don't, we can subset the data to reflect the two subsets.

```{r}
# countries that have not adopted open access policy: United States, Mexico, Slovak Republic
non_open_countries <- subset(data, Country %in% c("United States", "Mexico", "Slovak Republic"))

# countries that adopted open access policy
open_countries <- subset(data, !(Country %in% c("United States", "Mexico", "Slovak Republic")))
```

# Univariate Analysis of Key Variables

## Penetration

First, wanted to look at summary statistics to see how values vary in units and size and whether there are any clear indications of outliers in each variable.

```{r}
summary(data[, which(names(data)=="Penetration.per.100.OECD..2008"):which(names(data)=="Percent.of.population.in.urban.areas")])
```
* Any column header with “per.100” reflects the number of business and residential lines in a country by the the population of per 100 inhabitants. It is interesting to note that X2G.and.3G.penetration.per.100..OECD have values over 100. We can assume that carriers of mobile devices can flow from one region of 100 inhabitants to another making the data more inflated than it actually is or 2G and 3G group counts a single individual twice if he/she had a mobile carrier that deliver both 2G and 3G, but further investigation is required for its cause.
* Time of dataset may be an unspoken factor, since Penetration dataset includes information from 2008 and 2007.
* Growth.in.3G.penetration and Percent.of.population.in.urban.areas are in percent units instead of per 100 inhabitants.
* It is not clear whether Household.penetration..OECD are in percent units or in number per 100 inhabitants.  
* Wi.Fi.hotspots..JiWire values have a much higher range than all other variables, but we do not know if that number just reflects the total number of WiFi hotspots available in a given country.
* Penetration.per.100.OECD..2008 and Penetration.per.100.GC are close in distribution of values. We can assume that the two column are collected in the same year by different groups, but further clarification is necessary.

First, we wanted to look at the relationship between each of the Penetration variables.
```{r}
plot(data[,which(names(data)=="Penetration.per.100.OECD..2008"):which(names(data)=="Percent.of.population.in.urban.areas")])
```
From the above results, it appears that Penetration per 100 inhabitants OECD 2007 and 2008, Penetration per 100GC and Penetration per 100 Households have stronger correlations than any other variables.

Given the strong correlation, we decided to look at the change of Penetration from 2007 to 2008.
```{r}
# format the data
pen2007 <- data.frame(group="2007", value=data$Penetration.per.100.OECD..2007)
pen2008 <- data.frame(group="2008", value=data$Penetration.per.100.OECD..2008)
pen <- rbind(pen2007, pen2008)

# plot
ggplot(pen,
       aes(x=group, y=value)) + 
       geom_boxplot() + 
       labs(title="Penetration per 100 Inhabitants 2007-2008", x="", y="penetration per 100")
```
As expected based on the summary stats, there was an increase in overall penetration, demonstrated by the higher median, minimum and maximum. 

To look into it a little deeper, we looked at the difference in values between 2007 and 2008.
```{r}
Difference <- data$Penetration.per.100.OECD..2008 - data$Penetration.per.100.OECD..2007
cat("Country with negative growth:\n")
cat(sprintf("%s: %g\n", data$Country[which(Difference < 0)], Difference[which(Difference < 0)]))
```

With the exception of Finland all other OECD member countries saw growth in penetration per 100 inhabitants between 2007 and 2008. Interestingly, Finland shows negative growth of .01 inhabitants per 100 inhabitants. 

Next, we were interested in looking at the difference between penetration per 100 inhabitants versus penetration by household. 
```{r}
# format the data
pen2007 <-data.frame(group="2007",value=data$Penetration.per.100.OECD..2007)
pen2008 <- data.frame(group="2008", value=data$Penetration.per.100.OECD..2008)
penhouse <-data.frame(group="household",value=data$Household.penetration..OECD)
pen_house <-rbind(pen2007, pen2008, penhouse)
# plot
ggplot(pen_house,aes(x=group, y=value)) +geom_boxplot() +labs(title="Penetration per 100 Inhabitants 2007/2008 vs. per 100 Household", x="", y="Penetration per 100")
```
Looking at the distribution for each boxplot, Penetration per 100 inhabitants for both 2007 and 2008 have a smaller range and a lower median than Penetration per Household. Upon further reading on the OECD website, penetration by household may be higher since it includes some connections to businesses.

Though there didn't appear to be a correlation between penetration per 100 inhabitants and 2G or 3G penetration, we wanted to see if there may be a relationship between the growth rates.

```{r}
# add new column that calculates penetration growth from 2007 to 2008
data$Penetration_OECD_Growth <- (Difference/data$Penetration.per.100.OECD..2007)*100
pen_growth <-data.frame(group="general",value=data$Penetration_OECD_Growth)
growth_3g <- data.frame(group="3g", value=data$Growth.in.3G.penetration)

pen_growth <-rbind(pen_growth, growth_3g)
# plot
ggplot(pen_growth,aes(x=group, y=value)) +geom_boxplot() +labs(title="Penetration Growth: General vs. 3G", x="", y="in Percent")
```
General growth appeared much lower than 3G growth, and there appears to be a slightly negative correlation between the two. However, since we don't know the time range for the Growth in 3G penetration variable, we cannot draw any conclusions.
```{r}
cor(data[,c("Penetration_OECD_Growth","Growth.in.3G.penetration")],use = "complete.obs")
```


## Price

```{r}
price_data <- data[, c("Price.for.low.speeds..combined", "Price.for.med.speeds..combined", "Price.for.high.speeds..combined", "Price.for.very.high.speeds..combined")]
summary(price_data)
```

Using the summary function, we can see that price seems to increase with increased speed. A boxplot will help to better visualize this. 

```{r}
boxplot(price_data,
        las=1, # all axis labels horizontal
        names=c("low", "medium", "high", "very high"),
        main="Comparing price for different speeds",
        xlab="Speed",
        ylab="Price")
```

What is noticed from the boxplot visualization is that the lower speeds tend to have a smaller standard deviation or spread. 

```{r}
# standard deviation for low speed
sd(data$Price.for.low.speeds..combined, na.rm = TRUE)

# standard deviation for medium speed
sd(data$Price.for.med.speeds..combined, na.rm = TRUE)

# standard deviation for high speed
sd(data$Price.for.high.speeds..combined, na.rm = TRUE)

# standard deviation for very high speed
sd(data$Price.for.very.high.speeds..combined, na.rm = TRUE)
```

As can be observed, low and medium speed have an overall lower standard deviation than high or very high speed, which demonstrates that the price range for higher speed service is more variable. 

Presumably the evolution of high and very high speed networks are newer, and therefore not existent in every country, generating a missing (NA) data point in those countries where high/very high speed networks aren't available. From the summaries previously posted, we see that there are more missing data points the faster the speed is: from 1 missing data point in low speed to 11 missing data points in very high speed.

It could be argued that in the countries where very high speed internet isn't available, the network as a whole is newer and perhaps more costly. In order to explore this, analyzing the mean price for low to medium speeds where very high speed isn't available could be enlightening. The reason why we chose very high speed is discussed earlier in the section; the two countries that do not have data point for high speed are Mexico and Turkey and they also do not have data point for very high speed.

```{r}
na_very_high_speed <- data[is.na(data$Price.for.very.high.speeds..combined),]

sprintf("Is the low speed mean of the filtered dataset (%s) greater than the average low speed mean (%s)? %s",
        mean(na_very_high_speed$Price.for.low.speeds..combined, na.rm=TRUE),
        mean(data$Price.for.low.speeds..combined, na.rm=TRUE),
        mean(na_very_high_speed$Price.for.low.speeds..combined, na.rm=TRUE) >
             mean(data$Price.for.low.speeds..combined, na.rm=TRUE))
sprintf("Is the medium speed mean of the filtered dataset (%s) greater than the average medium speed mean (%s)? %s",
        mean(na_very_high_speed$Price.for.med.speeds..combined, na.rm=TRUE),
        mean(data$Price.for.med.speeds..combined, na.rm=TRUE),
        mean(na_very_high_speed$Price.for.med.speeds..combined, na.rm=TRUE) >
             mean(data$Price.for.med.speeds..combined, na.rm=TRUE))
# We understand that this will not include Mexico and Turkey
sprintf("Is the high speed mean of the filtered dataset (%s) greater than the average high speed mean (%s)? %s",
        mean(na_very_high_speed$Price.for.high.speeds..combined, na.rm=TRUE),
        mean(data$Price.for.high.speeds..combined, na.rm=TRUE),
        mean(na_very_high_speed$Price.for.high.speeds..combined, na.rm=TRUE) >
             mean(data$Price.for.high.speeds..combined, na.rm=TRUE))
```

From our analysis, all instances where Very High Speed internet isn't available, the average price of the three other tiers is higher than the overall average for that class. 

### TODO: check the map and include the outliers, skewness, and kurtosis

mapDevice()
spdf <- joinCountryData2Map(Broadband, joinCode = "NAME", nameJoinColumn = "Country")
mapCountryData(spdf, nameColumnToPlot = "Price_MedSpeed", catMethod = "logFixedWidth", colourPalette = "topo")

Visualizing the data by map can help to see that price for broadband can be categorized by region. The majority of European countries have low cost Broadband service, with a few outliers. North America also appears on the lower end in terms of cost. Australia and the pacific have the highest price by region. 

## Speed

We can begin to look at the advertised speed and compare that to the actual speed. As shown in the boxplot below, the advertised speed appears to be significantly higher than the actual speed. Interesting to note is the claim advertisement seems to promise for its maximum advertised speed, going so far as having an outlier of 1,000,000 kbps. It appears to be outside the scope of what the actual speed can deliver. It comes to no surprise then the histogram of maximum advertised speed appears to be more positively skewed in comparison to the histogram of average actual speed. In general, the maximum advertised speed and the average advertised speed have a wider spread due to their respective standard deviation being larger than the average actual speed; it can be assumed that advertisements are not limited by actual hardware limitations in terms of claimed speed. 

```{r}
# format the data
max_ad_speed <- data.frame(group="max ad", value=data$Maximum.advertised.speed.OECD..kbps.)
avg_ad_speed <- data.frame(group="avg ad", value=data$Average.advertised.speed.OECD..kbps.)
avg_actual_speed <- data.frame(group="avg actual", value=data$Average.actual.speed..Akamai..kbps.)
ad_speed <- rbind(max_ad_speed, avg_ad_speed, avg_actual_speed)

# plot
w_outliers <- ggplot(ad_speed,
                     aes(x=group, y=value)) + 
              geom_boxplot() + 
              labs(title="with outliers", x="", y="Speed (kbps)")

# compute lower and upper whisker limits
max_ad_speed_wo_outliers <- data$Maximum.advertised.speed.OECD..kbps.[!data$Maximum.advertised.speed.OECD..kbps. %in% boxplot.stats(data$Maximum.advertised.speed.OECD..kbps.)$out]
avg_ad_speed_wo_outliers <- data$Average.advertised.speed.OECD..kbps.[!data$Average.advertised.speed.OECD..kbps. %in% boxplot.stats(data$Average.advertised.speed.OECD..kbps.)$out]
avg_actual_speed_wo_outliers <- data$Average.actual.speed..Akamai..kbps.[!data$Average.actual.speed..Akamai..kbps. %in% boxplot.stats(data$Average.actual.speed..Akamai..kbps.)$out]
upper_limit <- max(max_ad_speed_wo_outliers, avg_ad_speed_wo_outliers, avg_actual_speed_wo_outliers, na.rm=TRUE)
lower_limit <- min(max_ad_speed_wo_outliers, avg_ad_speed_wo_outliers, avg_actual_speed_wo_outliers, na.rm=TRUE)

# plot
wo_outliers <- ggplot(ad_speed,
                      aes(x=group, y=value)) + 
               geom_boxplot(outlier.shape=NA) + 
               labs(title="without outliers", x="", y="Speed (kbps)") + 
               coord_cartesian(ylim=c(lower_limit, upper_limit))

grid.arrange(w_outliers, wo_outliers, ncol=2, top="Comparing advertised vs actual speed")
```

```{r}
max_h <- ggplot(data=data, 
                aes(data$Maximum.advertised.speed.OECD..kbps.)) + 
         geom_histogram() + 
         labs(title="max advertised", x="")

avg_h <- ggplot(data=data,
                aes(data$Average.advertised.speed.OECD..kbps.)) + 
         geom_histogram() + 
         labs(title="avg advertised", x="")

act_h <- ggplot(data=data,
                aes(data$Average.actual.speed..Akamai..kbps.)) + 
         geom_histogram() + 
         labs(title="avg actual", x="")
grid.arrange(max_h, avg_h, act_h, ncol=3, top="Histograms of advertised vs actual speed")
```

```{r}
cat("Number of outliers for maximum advertised speed: ",
    length(boxplot.stats(data$Maximum.advertised.speed.OECD..kbps.)$out))
cat("\nNumber of outliers for average advertised speed: ", 
    length(boxplot.stats(data$Average.advertised.speed.OECD..kbps.)$out))
cat("\nNumber of outliers for average actual speed: ", 
    length(boxplot.stats(data$Average.actual.speed..Akamai..kbps.)$out))
cat("\nSkewness of maximum advertised speed without outliers: ",
    skewness(max_ad_speed_wo_outliers))
cat("\nSkewness of average advertised speed without outliers: ", 
    skewness(avg_ad_speed_wo_outliers))
cat("\nSkewness of average actual speed without outliers: ", 
    skewness(avg_actual_speed_wo_outliers, na.rm=TRUE))
cat("\nStandard deviation of maximum advertised speed without outliers: ",
    sd(max_ad_speed_wo_outliers))
cat("\nStandard deviation of average advertised speed without outliers: ", 
    sd(avg_ad_speed_wo_outliers))
cat("\nStandard deviation of average actual speed without outliers: ", 
    sd(avg_actual_speed_wo_outliers, na.rm=TRUE))
```

What would be interesting to determine is to see if the advertised speed would be significantly higher in countries that do not adopt open source policies compared to countries that do. Although we have verified that outliers such as Japan and Korea have faster internet speed in general, we removed them while creating the boxplot for better visual clarity. What we have found out is that although countries that do not adopt open access policy do not appear to advertise internet speed higher than the other OECD countries, they do in general have a lower average actual speed. The data is not thoroughly conclusive as Slovak Republic do not have its actual average speed reported.  

```{r}
cat("Countries that adopt open access policy:\n")
cat("Number of outliers for average advertised speed: ",
    subset(data, Average.advertised.speed.OECD..kbps. %in%
             boxplot.stats(open_countries$Average.advertised.speed.OECD..kbps.)$out)$Country,
    "\n",
    sep="  ")
cat("Number of outliers for average advertised speed: ",
    subset(data, Average.actual.speed..Akamai..kbps. %in%
             boxplot.stats(open_countries$Average.actual.speed..Akamai..kbps.)$out)$Country,
    "\n",
    sep="  ")

cat("\nCountries that do not adopt open access policy:\n")
cat("Number of outliers for average advertised speed: ", length(boxplot.stats(non_open_countries$Average.advertised.speed.OECD..kbps.)$out))
cat("\nNumber of outliers for average advertised speed: ", length(boxplot.stats(non_open_countries$Average.actual.speed..Akamai..kbps.)$out))
```


```{r}
# format the data
avg_ad_speed <- data.frame(group="avg ad", value=open_countries$Average.advertised.speed.OECD..kbps.)
avg_actual_speed <- data.frame(group="avg actual", value=open_countries$Average.actual.speed..Akamai..kbps.)
o_ad_speed <- rbind(avg_ad_speed, avg_actual_speed)

avg_ad_speed <- data.frame(group="avg ad", value=non_open_countries$Average.advertised.speed.OECD..kbps.)
avg_actual_speed <- data.frame(group="avg actual", value=non_open_countries$Average.actual.speed..Akamai..kbps.)
no_ad_speed <- rbind(avg_ad_speed, avg_actual_speed)

# compute lower and upper whisker limits
o_avg_ad_speed_wo_outliers <- open_countries$Average.advertised.speed.OECD..kbps.[!open_countries$Average.advertised.speed.OECD..kbps. %in% boxplot.stats(open_countries$Average.advertised.speed.OECD..kbps.)$out]
o_avg_actual_speed_wo_outliers <- open_countries$Average.actual.speed..Akamai..kbps.[!open_countries$Average.actual.speed..Akamai..kbps. %in% boxplot.stats(open_countries$Average.actual.speed..Akamai..kbps.)$out]

no_avg_ad_speed_wo_outliers <- non_open_countries$Average.advertised.speed.OECD..kbps.[!non_open_countries$Average.advertised.speed.OECD..kbps. %in% boxplot.stats(non_open_countries$Average.advertised.speed.OECD..kbps.)$out]
no_avg_actual_speed_wo_outliers <- non_open_countries$Average.actual.speed..Akamai..kbps.[!non_open_countries$Average.actual.speed..Akamai..kbps. %in% boxplot.stats(non_open_countries$Average.actual.speed..Akamai..kbps.)$out]

upper_limit <- max(o_avg_ad_speed_wo_outliers, o_avg_actual_speed_wo_outliers, 
                   no_avg_ad_speed_wo_outliers, no_avg_actual_speed_wo_outliers, na.rm=TRUE)
lower_limit <- min(o_avg_ad_speed_wo_outliers, o_avg_actual_speed_wo_outliers, 
                   no_avg_ad_speed_wo_outliers, no_avg_actual_speed_wo_outliers, na.rm=TRUE)

boxplot_o <- ggplot(o_ad_speed,
                    aes(x=group, y=value)) + 
             geom_boxplot(outlier.shape=NA) + 
             labs(title="open policy without outliers", x="", y="Speed (kbps)") + 
             coord_cartesian(ylim=c(lower_limit, upper_limit))

boxplot_no <- ggplot(no_ad_speed,
                     aes(x=group, y=value)) + 
              geom_boxplot(outlier.shape=NA) + 
              labs(title="non-open policy without outliers", x="", y="Speed (kbps)") + 
              coord_cartesian(ylim=c(lower_limit, upper_limit))
 
grid.arrange(boxplot_o, boxplot_no, ncol=2, top="Comparing advertised vs actual speed")
```

The mean of the average download speedtest is higher than the median download speedtest, which tells us that the download speed might be positively skewed. The same can be said for latency and upload speed. In this aspect, countries that adopt open access policy do not seem to differ from countries that do not adopt open access policy.

We can roughly estimate that upload speed have more variability than latency which in turn have more variability than download speed, but without the full data to verify, this is just a rough estimate based on comparing the standard deviation to the mean. Again, in this aspect, countries that adopt open access policy do not seem to differ from countries that do not adopt open access policy.

```{r}
# Download
cat("Summary of average download speedtest:\n")
summary(data$Average.download.speedtest.net..kbps.)
cat("\nSummary of median download speedtest:\n")
summary(data$Median.download..speedtest.net..kbps.)
cat("\nStandard deviation of download speedtest:\n")
summary(data$Standard.deviation.download..speedtest.net)

# Upload
cat("\nSummary of average upload speedtest:\n")
summary(data$Average.upload.speedtest.net..kbps.)
cat("\nSummary of median upload speedtest:\n")
summary(data$Median.upload..speedtest.net..kbps.)
cat("\nStandard deviation of upload speedtest:\n")
summary(data$Standard.deviation.upload..speedtest.net)

# Latency
cat("\nSummary of average latency speedtest:\n")
summary(data$Average.latency.speedtest.net)
cat("\nSummary of median latency speedtest:\n")
summary(data$Median.latency..speedtest.net)
cat("\nStandard deviation of latency speedtest:\n")
summary(data$Standard.deviation.latency..speedtest.net)
```

```{r}
cat("Countries that adopt open access policy: ")

# Download
cat("Summary of average download speedtest:\n")
summary(open_countries$Average.download.speedtest.net..kbps.)
cat("\nSummary of median download speedtest:\n")
summary(open_countries$Median.download..speedtest.net..kbps.)
cat("\nStandard deviation of download speedtest:\n")
summary(open_countries$Standard.deviation.download..speedtest.net)

# Upload
cat("\nSummary of average upload speedtest:\n")
summary(open_countries$Average.upload.speedtest.net..kbps.)
cat("\nSummary of median upload speedtest:\n")
summary(open_countries$Median.upload..speedtest.net..kbps.)
cat("\nStandard deviation of upload speedtest:\n")
summary(open_countries$Standard.deviation.upload..speedtest.net)

# Latency
cat("\nSummary of average latency speedtest:\n")
summary(open_countries$Average.latency.speedtest.net)
cat("\nSummary of median latency speedtest:\n")
summary(open_countries$Median.latency..speedtest.net)
cat("\nStandard deviation of latency speedtest:\n")
summary(open_countries$Standard.deviation.latency..speedtest.net)
```

```{r}
cat("Countries that do not adopt open access policy: ")

# Download
cat("Summary of average download speedtest:\n")
summary(non_open_countries$Average.download.speedtest.net..kbps.)
cat("\nSummary of median download speedtest:\n")
summary(non_open_countries$Median.download..speedtest.net..kbps.)
cat("\nStandard deviation of download speedtest:\n")
summary(non_open_countries$Standard.deviation.download..speedtest.net)

# Upload
cat("\nSummary of average upload speedtest:\n")
summary(non_open_countries$Average.upload.speedtest.net..kbps.)
cat("\nSummary of median upload speedtest:\n")
summary(non_open_countries$Median.upload..speedtest.net..kbps.)
cat("\nStandard deviation of upload speedtest:\n")
summary(open_countries$Standard.deviation.upload..speedtest.net)

# Latency
cat("\nSummary of average latency speedtest:\n")
summary(non_open_countries$Average.latency.speedtest.net)
cat("\nSummary of median latency speedtest:\n")
summary(non_open_countries$Median.latency..speedtest.net)
cat("\nStandard deviation of latency speedtest:\n")
summary(open_countries$Standard.deviation.latency..speedtest.net)
```

# Analysis of Key Relationships

## Penetration and Speed

Network owners in US argues that adopting the open access policies will create a trade-off among price, speed, and penetration. For this reason, we will look into countries that do not adopt open access policies and see if the speed and penetration are reflectively better than countries that do not.

We will look into the most recent penetration data Penetration.per.100.OECD..2008, which reflects both businesses and residences before diving in to penetration data in household (Household.penetration..OECD), in mobile 3G (X3G.penetration.per.100), and in WiFi hotspots (Wi.Fi.hotspots.per.100.000..JiWire). We will compare it to the average actual speed (Average.actual.speed..Akamai..kbps.). Then, we will look at the relationship of penetration and  price for medium speed as well as speed and price for medium speed because each country has price for medium speed (Price.for.med.speeds..combined).

scatter plot with a superimposed smoothed line of prediction. The shaded region embracing the blue line is a representation of the 95% confidence limits for the estimated prediction.

```{r}
g1 <- ggplot(data, 
             aes(x=Penetration.per.100.OECD..2008, y=Average.actual.speed..Akamai..kbps., label=Country.Code)) +
      geom_point(data=open_countries) +
      geom_point(data=non_open_countries, color="red") + 
      geom_smooth() + 
      geom_text(data=non_open_countries, hjust=-1, vjust=1) + 
      labs(title="Penetration vs Speed", 
           x="penetration per 100 inhabitants", 
           y="average actual speed (kbps)")
g2 <- ggplot(data, 
             aes(x=Household.penetration..OECD, y=Average.actual.speed..Akamai..kbps., label=Country.Code)) +
      geom_point(data=open_countries) +
      geom_point(data=non_open_countries, color="red") + 
      geom_smooth() + 
      geom_text(data=non_open_countries, hjust=-1, vjust=1) +
      labs(title="Household Penetration vs Speed", 
           x="penetration (per 100 inhabitants, assuming)", 
           y="average actual speed (kbps)")
g3 <- ggplot(data, 
             aes(x=X3G.penetration.per.100, y=Average.actual.speed..Akamai..kbps., label=Country.Code)) +
      geom_point(data=open_countries) +
      geom_point(data=non_open_countries, color="red") + 
      geom_smooth() + 
      geom_text(data=non_open_countries, hjust=-1, vjust=1) +
      labs(title="3G Penetration vs Speed", 
           x="penetration per 100 inhabitants", 
           y="average actual speed (kbps)")
  
g4 <- ggplot(data, 
             aes(x=Wi.Fi.hotspots.per.100.000..JiWire, y=Average.actual.speed..Akamai..kbps., label=Country.Code)) +
      geom_point(data=open_countries) +
      geom_point(data=non_open_countries, color="red") + 
      geom_smooth() + 
      geom_text(data=non_open_countries, hjust=-1, vjust=1) +
      labs(title="WiFi Hotspots Penetration vs Speed", 
           x="penetration per 100 inhabitants", 
           y="average actual speed (kbps)")

grid.arrange(g1, g2, g3, g4, ncol=2, top="Bivariate analysis of penetration and average actual speed")
```

```{r}
with(data, cor(Penetration.per.100.OECD..2008, Average.actual.speed..Akamai..kbps., use="pairwise.complete.obs"))
with(data, cor(Household.penetration..OECD, Average.actual.speed..Akamai..kbps., use="pairwise.complete.obs"))
with(data, cor(X3G.penetration.per.100, Average.actual.speed..Akamai..kbps., use="pairwise.complete.obs"))
with(data, cor(Wi.Fi.hotspots.per.100.000..JiWire, Average.actual.speed..Akamai..kbps., use="pairwise.complete.obs"))

with(open_countries, cor(Penetration.per.100.OECD..2008, Average.actual.speed..Akamai..kbps., use="pairwise.complete.obs"))
with(open_countries, cor(Household.penetration..OECD, Average.actual.speed..Akamai..kbps., use="pairwise.complete.obs"))
with(open_countries, cor(X3G.penetration.per.100, Average.actual.speed..Akamai..kbps., use="pairwise.complete.obs"))
with(open_countries, cor(Wi.Fi.hotspots.per.100.000..JiWire, Average.actual.speed..Akamai..kbps., use="pairwise.complete.obs"))

with(non_open_countries, cor(Penetration.per.100.OECD..2008, Average.actual.speed..Akamai..kbps., use="pairwise.complete.obs"))
with(non_open_countries, cor(Household.penetration..OECD, Average.actual.speed..Akamai..kbps., use="pairwise.complete.obs"))
with(non_open_countries, cor(X3G.penetration.per.100, Average.actual.speed..Akamai..kbps., use="pairwise.complete.obs"))
with(non_open_countries, cor(Wi.Fi.hotspots.per.100.000..JiWire, Average.actual.speed..Akamai..kbps., use="pairwise.complete.obs"))

sum(is.na(non_open_countries$Penetration.per.100.OECD..2008))
sum(is.na(non_open_countries$Household.penetration..OECD))
sum(is.na(non_open_countries$X3G.penetration.per.100))
sum(is.na(non_open_countries$Wi.Fi.hotspots.per.100.000..JiWire))
sum(is.na(non_open_countries$Average.actual.speed..Akamai..kbps.))
```

## Penetration and Price

```{r}
g1 <- ggplot(data, 
             aes(x=Penetration.per.100.OECD..2008, y=Price.for.med.speeds..combined, label=Country.Code)) +
      geom_point(data=open_countries) +
      geom_point(data=non_open_countries, color="red") + 
      geom_smooth() + 
      geom_text(data=non_open_countries, hjust=-1, vjust=1) + 
      labs(title="Penetration vs Price", 
           x="penetration per 100 inhabitants", 
           y="price for medium speed")
g2 <- ggplot(data, 
             aes(x=Household.penetration..OECD, y=Price.for.med.speeds..combined, label=Country.Code)) +
      geom_point(data=open_countries) +
      geom_point(data=non_open_countries, color="red") + 
      geom_smooth() + 
      geom_text(data=non_open_countries, hjust=-1, vjust=1) +
      labs(title="Household Penetration vs Price", 
           x="penetration (per 100 inhabitants, assuming)", 
           y="price for medium speed")
g3 <- ggplot(data, 
             aes(x=X3G.penetration.per.100, y=Price.for.med.speeds..combined, label=Country.Code)) +
      geom_point(data=open_countries) +
      geom_point(data=non_open_countries, color="red") + 
      geom_smooth() + 
      geom_text(data=non_open_countries, hjust=-1, vjust=1) +
      labs(title="3G Penetration vs Price", 
           x="penetration per 100 inhabitants", 
           y="price for medium speed")
  
g4 <- ggplot(data, 
             aes(x=Wi.Fi.hotspots.per.100.000..JiWire, y=Price.for.med.speeds..combined, label=Country.Code)) +
      geom_point(data=open_countries) +
      geom_point(data=non_open_countries, color="red") + 
      geom_smooth() + 
      geom_text(data=non_open_countries, hjust=-1, vjust=1) +
      labs(title="WiFi Hotspots Penetration vs Price", 
           x="penetration per 100 inhabitants", 
           y="price for medium speed")

grid.arrange(g1, g2, g3, g4, ncol=2, top="Bivariate analysis of penetration and price for medium speed")
```

```{r}
with(data, cor(Penetration.per.100.OECD..2008, Price.for.med.speeds..combined, use="pairwise.complete.obs"))
with(data, cor(Household.penetration..OECD, Price.for.med.speeds..combined, use="pairwise.complete.obs"))
with(data, cor(X3G.penetration.per.100, Price.for.med.speeds..combined, use="pairwise.complete.obs"))
with(data, cor(Wi.Fi.hotspots.per.100.000..JiWire, Price.for.med.speeds..combined, use="pairwise.complete.obs"))

with(open_countries, cor(Penetration.per.100.OECD..2008, Price.for.med.speeds..combined, use="pairwise.complete.obs"))
with(open_countries, cor(Household.penetration..OECD, Price.for.med.speeds..combined, use="pairwise.complete.obs"))
with(open_countries, cor(X3G.penetration.per.100, Price.for.med.speeds..combined, use="pairwise.complete.obs"))
with(open_countries, cor(Wi.Fi.hotspots.per.100.000..JiWire, Price.for.med.speeds..combined, use="pairwise.complete.obs"))

with(non_open_countries, cor(Penetration.per.100.OECD..2008, Price.for.med.speeds..combined, use="pairwise.complete.obs"))
with(non_open_countries, cor(Household.penetration..OECD, Price.for.med.speeds..combined, use="pairwise.complete.obs"))
with(non_open_countries, cor(X3G.penetration.per.100, Price.for.med.speeds..combined, use="pairwise.complete.obs"))
with(non_open_countries, cor(Wi.Fi.hotspots.per.100.000..JiWire, Price.for.med.speeds..combined, use="pairwise.complete.obs"))

sum(is.na(non_open_countries$Penetration.per.100.OECD..2008))
sum(is.na(non_open_countries$Household.penetration..OECD))
sum(is.na(non_open_countries$X3G.penetration.per.100))
sum(is.na(non_open_countries$Wi.Fi.hotspots.per.100.000..JiWire))
sum(is.na(non_open_countries$Price.for.med.speeds..combined))
```
## Speed and Price

```{r}
ggplot(data, 
       aes(x=Average.actual.speed..Akamai..kbps., y=Price.for.med.speeds..combined, label=Country.Code)) +
geom_point(data=open_countries) +
geom_point(data=non_open_countries, color="red") + 
geom_smooth() + 
geom_text(data=non_open_countries, hjust=-1, vjust=1) + 
labs(title="Bivariate analysis of average actual speed and price for medium speed", 
     x="speed (kbps)", 
     y="price for medium speed ($, assuming)")
```

```{r}
with(data, cor(Average.actual.speed..Akamai..kbps., Price.for.med.speeds..combined, use="pairwise.complete.obs"))

with(open_countries, cor(Average.actual.speed..Akamai..kbps., Price.for.med.speeds..combined, use="pairwise.complete.obs"))

with(non_open_countries, cor(Average.actual.speed..Akamai..kbps., Price.for.med.speeds..combined, use="pairwise.complete.obs"))

sum(is.na(non_open_countries$Average.actual.speed..Akamai..kbps.))
sum(is.na(non_open_countries$Price.for.med.speeds..combined))
```

# Analysis of Secondary Effects

For penetration, we do not know if the Household.penetration..OECD was measured in percentages or per 100 inhabitants. We assume it was per 100 inhabitants, but if it was in percentages, our outcomes based on this data are not accurate.

We might be inhibited from understanding the data better because we do not know what Penetration.per.100.GC measure.

For price, we are under the assumption that the price is based on the US dollar. We also assume that the price is converted from the country’s origin to US dollar; otherwise our analysis cannot be relied upon.

For speed, we decided to skip X90p..Download..speedtest.net..kbps., X90p..Upload..speedtest.net..kbps., and X10p..Latency..speedtest.net as we cannot be certain what these data measure. 

Another important aspect to note is how the average actual speed is measured because we do not know for certain if the speed collected reflects 3G speed, WiFi speed, Fiber speed, etc. or all of the above. We also do not know if the average actual speed reflects the download, upload, and latency or just the download speed for example. Also, based on the column header’s name, we do not know how Akamai collect its speed data in comparison to speedtest.net. For this reason, we cannot be certain if the relationships reflected in the analysis are valid unless we are able to explore more on the dataset’s definition of average actual speed.

We also removed outliers in our univariate analysis of speed because we are not certain if the values reflected are the actual or simply bolstered speed. Because we removed these outliers, if the outliers are indeed actual speed reflected in the country, our analysis will reflect speed that is much slower than actual.


# Conclusion

